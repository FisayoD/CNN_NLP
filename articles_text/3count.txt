272024
1
CountingÂ Techniques
orÂ howÂ toÂ countÂ withoutÂ 
explicitlyÂ counting
1
â€¢ WhatÂ doÂ theÂ followingÂ problemsÂ haveÂ inÂ common
1
CountÂ theÂ numberÂ ofÂ waysÂ toÂ selectÂ aÂ dozenÂ donutsÂ whenÂ thereÂ areÂ fiveÂ 
typesÂ available
2
CountÂ theÂ numberÂ ofÂ 16â€bitÂ numbersÂ withÂ exactlyÂ 4Â onesÂ andÂ 12Â zeroes
2
Warmup
Answer 1820 why
1
2
272024
2
1 DeterminingÂ theÂ timeÂ andÂ spaceÂ requiredÂ toÂ solveÂ aÂ problemÂ 
alwaysÂ involvesÂ solvingÂ aÂ countingÂ problemÂ sizeÂ ofÂ dataÂ structuresÂ 
numberÂ ofÂ iterationsÂ ofÂ aÂ loopÂ numberÂ ofÂ recursiveÂ callsÂ etc
2 CountingÂ isÂ theÂ foundationÂ ofÂ discreteÂ probabilityÂ theoryÂ whichÂ 
playsÂ aÂ centralÂ roleÂ inÂ theÂ analysisÂ ofÂ systemsÂ egÂ networksÂ 
cryptographyÂ andÂ theÂ designÂ ofÂ randomizedÂ algorithms
3 TwoÂ remarkableÂ techniquesÂ theÂ pigeonholeÂ principleÂ andÂ 
combinatorialÂ proofsÂ dependÂ onÂ counting
3
WhyÂ doÂ weÂ care
ADDITION RULEÂ IfÂ anÂ objectÂ mustÂ beÂ selectedÂ eitherÂ fromÂ aÂ pileÂ ofÂ ğ‘ itemsÂ 
or fromÂ anotherÂ pileÂ ofÂ ğ‘ itemsÂ thenÂ theÂ selectionÂ canÂ beÂ madeÂ inÂ ğ‘ àµ… ğ‘
differentÂ waysÂ 
4
BasicÂ Principles
MULTIPLICATION RULEÂ IfÂ twoÂ objectsÂ mustÂ beÂ chosenÂ theÂ firstÂ oneÂ fromÂ aÂ 
pileÂ ofÂ ğ‘ itemsÂ and theÂ secondÂ oneÂ fromÂ aÂ pileÂ ofÂ ğ‘ itemsÂ thenÂ theÂ 
selectionÂ canÂ beÂ madeÂ inÂ ğ‘ àµˆ ğ‘ differentÂ waysÂ 
ExampleÂ AÂ lunchÂ specialÂ includesÂ soupÂ or saladÂ IfÂ thereÂ areÂ 4Â typesÂ ofÂ soupsÂ 
andÂ 3Â typesÂ ofÂ saladÂ thenÂ youÂ haveÂ ğŸ’ àµ… ğŸ‘ àµŒ ğŸ• optionsÂ toÂ chooseÂ from
ExampleÂ AÂ dinnerÂ specialÂ includesÂ soupÂ and saladÂ IfÂ thereÂ areÂ 4Â typesÂ ofÂ soupsÂ 
andÂ 3Â typesÂ ofÂ saladÂ thenÂ youÂ haveÂ ğŸ’ Â· ğŸ‘ àµŒ ğŸğŸ optionsÂ toÂ chooseÂ from
3
4
272024
3
ADDITION RULEÂ IfÂ ğ´ andÂ ğµ areÂ disjointÂ setsÂ thenÂ  ğ´ âˆª ğµ àµŒ ğ´ àµ… ğµ
5
InÂ TermsÂ ofÂ Setsâ€¦
MULTIPLICATION RULEÂ TheÂ numberÂ ofÂ pairsÂ ofÂ theÂ formÂ áˆºğ‘¥ ğ‘¦áˆ» whereÂ 
ğ‘¥ âˆˆ ğ´ andÂ ğ‘¦ âˆˆ ğµ isÂ  ğ´ àµˆ ğµ àµŒ ğ´ â‹… ğµ
ExerciseÂ WhatÂ isÂ |ğ´ âˆª ğµ| ifÂ ğ´ andÂ ğµ areÂ notÂ necessarilyÂ disjoint
ğ‘¨
ğ‘©
ğ‘¨ âˆ© ğ‘©
â€¢ TheÂ additionÂ andÂ multiplicationÂ rulesÂ canÂ ofÂ courseÂ beÂ 
generalizedÂ toÂ anyÂ numberÂ ofÂ sets
6
Generalization
IfÂ aÂ setÂ ğ‘† ofÂ objectsÂ isÂ partitioned intoÂ subsetsÂ ğ‘†à¬µ ğ‘†à¬¶ â€¦  ğ‘†à¯ Â then
ï€­AnÂ objectÂ canÂ beÂ chosenÂ fromÂ ğ‘† inÂ  ğ‘†à¬µ àµ… ğ‘†à¬¶ àµ… â‹¯ àµ… ğ‘†à¯  ways
ï€­AnÂ ğ‘šâ€tupleÂ  ğ‘¥à¬µ ğ‘¥à¬¶ â€¦  ğ‘¥à¯  Â whereÂ ğ‘¥à¯œ âˆˆ ğ‘†à¯œÂ canÂ beÂ builtÂ inÂ Â Â Â Â Â Â 
ğ‘†à¬µ àµˆ ğ‘†à¬¶ àµˆ â‹¯ àµˆ ğ‘†à¯  differentÂ ways
5
6
272024
4
ExampleÂ YouÂ wantÂ toÂ recommendÂ anÂ introÂ programmingÂ bookÂ toÂ aÂ 
friendÂ SinceÂ youÂ haveÂ fourÂ booksÂ onÂ JavaÂ andÂ threeÂ onÂ PythonÂ thenÂ 
youÂ haveÂ 4 àµ… 3 àµŒ 7 choicesÂ forÂ yourÂ recommendationÂ IfÂ onÂ theÂ 
otherÂ handÂ youÂ wantÂ toÂ recommendÂ bothÂ aÂ bookÂ onÂ JavaÂ andÂ oneÂ onÂ 
PythonÂ thenÂ theÂ numberÂ choicesÂ isÂ 4 àµˆ 3 àµŒ 12
7
Examples
ExampleÂ TheÂ numberÂ ofÂ entriesÂ inÂ theÂ lookâ€upâ€tableÂ LUTÂ ofÂ aÂ frameÂ 
bufferÂ withÂ eightÂ bitsÂ perÂ pixelsÂ drivingÂ aÂ trueÂ colorÂ displayÂ isÂ 2à¬¼ àµŒ 256Â 
ThisÂ isÂ theÂ numberÂ ofÂ differentÂ colorsÂ thatÂ canÂ beÂ displayedÂ atÂ aÂ timeÂ inÂ 
aÂ singleÂ frameÂ ofÂ animationÂ eachÂ chosenÂ fromÂ aÂ paletteÂ ofÂ 256à¬· colors
ExampleÂ TheÂ numberÂ ofÂ vectorsÂ thatÂ canÂ beÂ constructedÂ toÂ beÂ incidentÂ 
onÂ aÂ setÂ ofÂ fourÂ pointsÂ inÂ generalÂ positionÂ isÂ atÂ mostÂ 13Â why
BIJECTION RULEÂ LetÂ X andÂ Y beÂ finiteÂ setsÂ IfÂ thereÂ isÂ aÂ bijectionÂ 
ğ‘“ ğ‘‹ â†’ ğ‘ŒÂ thenÂ  ğ‘‹ àµŒ ğ‘Œ 
8
BijectionÂ RuleÂ howÂ toÂ countÂ oneÂ thingÂ byÂ countingÂ another
â€¢ ThisÂ principleÂ asÂ obviousÂ asÂ itÂ appearsÂ whenÂ appliedÂ toÂ infiniteÂ setsÂ 
playsÂ aÂ fundamentalÂ roleÂ inÂ logicÂ andÂ computabilityÂ theory
ExerciseÂ HowÂ manyÂ subsetsÂ ofÂ ğ‘‹ àµŒ áˆ¼1 â€¦  ğ‘›áˆ½ haveÂ anÂ evenÂ 
numberÂ ofÂ elementsÂ andÂ howÂ manyÂ haveÂ andÂ oddÂ numberÂ 
UseÂ theÂ bijectionÂ rule
7
8
272024
5
â€¢ ConsiderÂ aÂ hashÂ tableÂ ofÂ sizeÂ ğ‘šÂ aÂ primeÂ number
â€¢ EachÂ keyÂ ğ‘¥ isÂ interpretedÂ asÂ consistingÂ ofÂ ğ‘Ÿ àµ… 1 â€œdigitsâ€Â inÂ baseÂ ğ‘š
9
UniversalÂ Hashing
â€¢
TheÂ setÂ â„‹ àµŒ â„à¯” ofÂ hashÂ functionsÂ satisfiesÂ forÂ allÂ keysÂ ğ‘¥ àµ ğ‘¦Â ifÂ ğ‘ isÂ 
chosenÂ atÂ randomÂ thenÂ Pr â„à¯” ğ‘¥ àµŒ â„à¯”áˆºğ‘¦áˆ» àµŒ 1ğ‘š provenÂ COMPÂ 3371
ğ‘¥ àµŒ âŸ¨ğ‘¥à¯¥ â‹¯ ğ‘¥à¬µğ‘¥à¬´âŸ©
ğ‘ àµŒ âŸ¨ğ‘à¯¥ â‹¯ ğ‘à¬µğ‘à¬´âŸ©
â„à¯” ğ‘¥ àµŒ à· ğ‘à¯œğ‘¥à¯œ
à¯¥
à¯œà­€à¬´
 mod ğ‘š
â€¢ TheÂ hashÂ functionÂ isÂ builtÂ usingÂ randomÂ áˆºğ‘Ÿ àµ… 1áˆ»â€digitÂ baseâ€ğ‘š numberÂ ğ‘
ExerciseÂ HowÂ manyÂ differentÂ hashingÂ functionsÂ areÂ there
Exercises
10
1 LetÂ ğ‘‹ beÂ aÂ setÂ ofÂ sizeÂ ğ‘› andÂ ğ‘Œ aÂ setÂ ofÂ sizeÂ ğ‘šÂ HowÂ manyÂ 
differentÂ mappingsÂ ğ‘“ ğ‘‹ â†’ ğ‘Œ areÂ there
2 LetÂ ğ‘‹ beÂ aÂ setÂ ofÂ sizeÂ ğ‘› andÂ ğ‘Œ aÂ setÂ ofÂ sizeÂ ğ‘šÂ HowÂ manyÂ 
differentÂ injective mappingsÂ ğ‘“ ğ‘‹ â†’ ğ‘Œ areÂ there
3 LetÂ ğ‘‹ beÂ aÂ setÂ ofÂ sizeÂ ğ‘› andÂ ğ‘Œ aÂ setÂ ofÂ sizeÂ ğ‘šÂ HowÂ manyÂ 
differentÂ surjective mappingsÂ ğ‘“ ğ‘‹ â†’ ğ‘Œ areÂ there
4 DescribeÂ aÂ bijectionÂ betweenÂ theÂ setÂ ofÂ 12â€packsÂ ofÂ donutsÂ 
selectedÂ fromÂ 5Â varietiesÂ andÂ theÂ setÂ ofÂ 16â€bitÂ binaryÂ 
sequencesÂ withÂ exactlyÂ fourÂ ones
9
10
272024
6
â€¢ AÂ generalizationÂ ofÂ theÂ bijectionÂ rule
â€¢ AÂ functionÂ ğ‘“ ğ‘‹ â†’ ğ‘Œ isÂ ğ‘˜â€toâ€1Â ifÂ itÂ isÂ surjectiveÂ andÂ forÂ everyÂ ğ‘¦ âˆˆ ğ‘ŒÂ theÂ 
relationÂ ğ‘“à¬¿à¬µáˆºğ‘¦áˆ» containsÂ exactlyÂ ğ‘˜ pointsÂ ofÂ ğ‘‹
11
DivisionÂ Rule
ExampleÂ LetÂ ğºáˆºğ‘‰ ğ¸áˆ» beÂ aÂ simpleÂ undirectedÂ graphÂ WhatÂ isÂ theÂ relationÂ 
betweenÂ theÂ numberÂ ofÂ edgesÂ andÂ theÂ sumÂ ofÂ degreesÂ ofÂ allÂ vertices
ExampleÂ TheÂ numberÂ ofÂ segmentsÂ ofÂ lengthÂ àµ 0 thatÂ canÂ beÂ constructedÂ 
toÂ beÂ incidentÂ onÂ aÂ setÂ ofÂ 4Â pointsÂ isÂ 6
DIVISION RULE LetÂ ğ‘‹ andÂ ğ‘Œ beÂ finiteÂ setsÂ IfÂ ğ‘“ ğ‘‹ â†’ ğ‘Œ isÂ ğ‘˜â€toâ€1Â thenÂ 
ğ‘‹ àµŒ ğ‘˜ â‹… ğ‘Œ
ReinterpretationÂ ifÂ eachÂ elementÂ ofÂ aÂ setÂ ğ‘Œ isÂ countedÂ ğ‘˜ timesÂ thenÂ 
ğ‘Œ àµŒ áˆºtotal countáˆ»ğ‘˜
PermutationsÂ TheÂ goalÂ isÂ toÂ countÂ orderedÂ arrangementsÂ orÂ orderedÂ 
selectionsÂ ofÂ objectsÂ withÂ orÂ withoutÂ repetitionÂ ofÂ objects
ArrangementÂ ğ‘ ğ‘ ğ‘ ğ‘ isÂ differentÂ fromÂ arrangementÂ ğ‘ ğ‘ ğ‘ ğ‘
12
CommonÂ ProblemÂ Types
CombinationsÂ TheÂ goalÂ isÂ toÂ countÂ unorderedÂ arrangementsÂ orÂ 
unorderedÂ selectionsÂ ofÂ objectsÂ withÂ orÂ withoutÂ repetitionÂ ofÂ objects
ArrangementÂ ğ‘ ğ‘ ğ‘ ğ‘ isÂ theÂ sameÂ asÂ arrangementÂ ğ‘ ğ‘ ğ‘ ğ‘
SinceÂ repetitionsÂ mayÂ beÂ allowedÂ weÂ distinguishÂ betweenÂ arrangementsÂ 
orÂ selectionsÂ fromÂ aÂ set orÂ fromÂ aÂ multisetÂ alsoÂ calledÂ aÂ bagÂ ForÂ theÂ 
caseÂ ofÂ multisetsÂ weÂ specifyÂ theÂ numberÂ ofÂ timesÂ anÂ objectÂ occursÂ asÂ 
illustratedÂ inÂ thisÂ exampleÂ ğ‘€ àµŒ 3 â‹… ğ‘ 1 â‹… ğ‘ 2 â‹… ğ‘ denotesÂ theÂ multisetÂ 
ğ‘€ àµŒ áˆ¼ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ ğ‘áˆ½Â InfinityÂ âˆÂ isÂ allowedÂ asÂ aÂ repetitionÂ count
11
12
272024
7
Example
â€¢ HowÂ manyÂ numbersÂ betweenÂ 1000Â andÂ 9999Â haveÂ distinctÂ 
digits
â€¢ OrderÂ isÂ importantÂ â‡’ problemÂ isÂ ofÂ theÂ permutationÂ type
â€¢ 9Â differentÂ valuesÂ canÂ appearÂ inÂ theÂ thousandsÂ 10Â inÂ theÂ 
hundredsÂ 10Â inÂ theÂ tensÂ andÂ 10Â inÂ theÂ units
ï€­ IsÂ 9 àµˆ 10 àµˆ 10 àµˆ 10 àµŒ 9000 theÂ correctÂ answer
â€¢ ThereÂ areÂ 9Â differentÂ choicesÂ forÂ theÂ thousandsÂ 9Â forÂ theÂ 
hundredsÂ 8Â forÂ theÂ tensÂ 7Â forÂ theÂ units
ï€­ TheÂ correctÂ answerÂ isÂ 9 àµˆ 9 àµˆ 8 àµˆ 7 àµŒ 4536
13
Example
â€¢ HowÂ manyÂ odd numbersÂ betweenÂ 1000Â andÂ 9999Â haveÂ distinctÂ 
digitsÂ 
â€¢ OrderÂ isÂ importantÂ â‡’ problemÂ isÂ ofÂ theÂ permutationÂ type
â€¢ ThereÂ areÂ 9Â possibilitiesÂ forÂ theÂ thousandsÂ 8Â forÂ theÂ hundredsÂ andÂ 
7Â forÂ theÂ tensÂ InÂ howÂ manyÂ waysÂ canÂ youÂ chooseÂ theÂ unitsÂ Â Â Â Â Â Â Â Â 
9 àµˆ 9 àµˆ 8 àµˆ 
â€¢ TheÂ correctÂ answerÂ isÂ 8 àµˆ 8 àµˆ 7 àµˆ 5 àµŒ 2240Â Why
ï€­ WeÂ haveÂ 5Â differentÂ choicesÂ forÂ theÂ unitsÂ 8Â forÂ theÂ thousandsÂ Â 
8Â forÂ theÂ hundredsÂ 7Â forÂ theÂ tens
14
ExerciseÂ HowÂ manyÂ even numbersÂ areÂ thereÂ betweenÂ 1000Â andÂ 9999
13
14
272024
8
â€¢ LetÂ ğ‘Ÿ âˆˆ â„•Â AnÂ râ€permutation ofÂ aÂ setÂ S ofÂ nÂ elementsÂ isÂ anÂ orderedÂ 
arrangementÂ ofÂ r ofÂ theÂ n elementsÂ 
â€¢ AÂ permutation ofÂ S isÂ simplyÂ anÂ nâ€permutationÂ ofÂ S
â€¢ ğ‘ƒ ğ‘› ğ‘Ÿ àµŒ theÂ numberÂ ofÂ râ€permutationsÂ ofÂ n elements
15
Permutations
ğ‘ƒáˆºğ‘› ğ‘Ÿáˆ» àµŒ
ğ‘›
ğ‘› àµ† ğ‘Ÿ 
TheoremÂ For ğ‘› and ğ‘Ÿ positiveÂ integersÂ withÂ ğ‘Ÿ àµ‘ ğ‘› ğ‘ƒ ğ‘› ğ‘Ÿ àµŒ
ğ‘› ğ‘› àµ† 1 áˆºğ‘› àµ† 2áˆ» â‹¯ áˆºğ‘› àµ† ğ‘Ÿ àµ… 1áˆ»
ExampleÂ IfÂ ğ‘† àµŒ ğ‘ ğ‘ ğ‘  thenÂ ğ‘ğ‘ ğ‘ğ‘ ğ‘ğ‘ ğ‘ğ‘ ğ‘ğ‘ ğ‘ğ‘ areÂ theÂ sixÂ 
2â€permutationsÂ ofÂ ğ‘† andÂ ğ‘ğ‘ğ‘Â ğ‘ğ‘ğ‘Â ğ‘ğ‘ğ‘Â ğ‘ğ‘ğ‘Â ğ‘ğ‘ğ‘Â ğ‘ğ‘ğ‘ areÂ theÂ 
sixÂ permutationsÂ ofÂ ğ‘†
1 TheÂ numberÂ ofÂ 4â€letterÂ variableÂ namesÂ thatÂ canÂ beÂ formedÂ usingÂ 
eachÂ ofÂ theÂ lettersÂ cÂ aÂ rÂ eÂ andÂ s atÂ mostÂ onceÂ isÂ ğ‘ƒ 54 àµŒ 120
ï€­WhatÂ isÂ theÂ numberÂ ofÂ 5â€letterÂ variableÂ namesÂ usingÂ theÂ sameÂ letters
2 TheÂ â€œ15â€puzzleâ€Â consistsÂ ofÂ 15Â slidingÂ squaresÂ labeledÂ 1Â throughÂ 15Â 
andÂ mountedÂ onÂ aÂ 4ï‚´4Â squareÂ frameÂ TheÂ numberÂ ofÂ differentÂ inputÂ 
puzzlesÂ isÂ ğ‘ƒ 1616 àµŒ 16Â ieÂ àµ20Â trillionÂ possibilities
16
Examples
15
16
272024
9
â€¢ TheÂ permutationsÂ consideredÂ soÂ farÂ areÂ linear
â€¢ IfÂ ğ‘› objectsÂ areÂ arrangedÂ inÂ aÂ circleÂ theÂ numberÂ ofÂ permutationsÂ decreasesÂ asÂ 
twoÂ circularÂ permutationsÂ areÂ equalÂ ifÂ oneÂ canÂ beÂ broughtÂ toÂ theÂ otherÂ byÂ aÂ 
rotationÂ 
17
CircularÂ Permutations
Example SupposeÂ weÂ arrangeÂ 10Â childrenÂ inÂ aÂ circle
SinceÂ eachÂ linearÂ permutationÂ givesÂ riseÂ toÂ 9Â otherÂ equivalentÂ onesÂ theÂ numberÂ 
ofÂ circularÂ permutationsÂ isÂ 
à¬µà¬´
à¬µà¬´ àµŒ 9
Theorem TheÂ numberÂ ofÂ circularÂ râ€permutationsÂ ofÂ aÂ setÂ ofÂ ğ‘› elementsÂ isÂ 
givenÂ by
ğ‘ƒáˆºğ‘› ğ‘Ÿáˆ»
ğ‘Ÿ
àµŒ
ğ‘›
ğ‘Ÿ ğ‘› àµ† ğ‘Ÿ 
â€¢ WhatÂ isÂ theÂ numberÂ ofÂ differentÂ 5â€letterÂ variablesÂ namesÂ withÂ atÂ leastÂ 
oneÂ upperâ€caseÂ letterÂ Â 
â€¢ WhatÂ isÂ theÂ numberÂ ofÂ necklacesÂ thatÂ canÂ beÂ madeÂ fromÂ 17Â differentÂ 
sphericalÂ beads
18
Exercises
17
18
272024
10
â€¢ Let ğ‘Ÿ beÂ aÂ nonâ€negativeÂ integerÂ AnÂ ğ‘Ÿâ€combination ofÂ aÂ setÂ ğ‘† of sizeÂ ğ‘›
isÂ anÂ ğ‘Ÿâ€elementÂ subsetÂ ofÂ ğ‘†
â€¢ TheÂ numberÂ ofÂ ğ‘Ÿâ€combinationsÂ ofÂ aÂ setÂ ofÂ sizeÂ ğ‘› isÂ denotedÂ byÂ 
ğ¶áˆºğ‘› ğ‘Ÿáˆ» orÂ  ğ‘›
ğ‘Ÿ
â€¢ InÂ particularÂ ğ¶ ğ‘› 0 àµŒ ğ¶ ğ‘› ğ‘› àµŒ 1 ğ¶ ğ‘› 1 àµŒ ğ‘› andÂ ifÂ ğ‘Ÿ àµ ğ‘› thenÂ 
ğ¶ ğ‘› ğ‘Ÿ àµŒ 0
â€¢ ForÂ convenienceÂ weÂ defineÂ ğ¶ 00 â‰” 0
19
Combinations
Theorem ForÂ ğ‘Ÿ àµ‘ ğ‘› ğ¶ ğ‘› ğ‘Ÿ àµŒ
à¯¡
à¯¥ à¯¡à¬¿à¯¥ 
20
BasicÂ formula
Proof Follows from ğ‘ƒ ğ‘› ğ‘Ÿ àµŒ ğ‘Ÿ ğ¶ ğ‘› ğ‘Ÿ
ExampleÂ LetÂ ğ‘† beÂ aÂ setÂ ofÂ 25Â distinctÂ pointsÂ onÂ theÂ planeÂ TheÂ 
maximumÂ numberÂ ofÂ linesÂ throughÂ pairsÂ ofÂ pointsÂ ofÂ ğ‘† isÂ 
ğ¶ 252 àµŒ
à¬¶à¬¹
à¬¶à¬·à¬¶ àµŒ 300
OnÂ theÂ otherÂ handÂ theÂ numberÂ ofÂ trianglesÂ withÂ verticesÂ fromÂ ğ‘† isÂ 
ğ¶ 253 àµŒ
à¬¶à¬¹
à¬¶à¬¶à¬· àµŒ 2300
Corollary For ğ‘Ÿ àµ‘ ğ‘› ğ¶ ğ‘› ğ‘Ÿ àµŒ ğ¶áˆºğ‘› ğ‘› àµ† ğ‘Ÿáˆ»
19
20
272024
11
HowÂ manyÂ 8â€letterÂ variableÂ namesÂ canÂ beÂ constructedÂ usingÂ theÂ 26Â 
lowerâ€caseÂ lettersÂ ofÂ theÂ alphabetÂ ifÂ eachÂ wordÂ containsÂ 4Â orÂ 5Â vowels
SolutionÂ ConsiderÂ 2Â casesÂ asÂ follows
1 TheÂ numberÂ ofÂ wordsÂ withÂ 4Â vowelsÂ isÂ ğ¶ 84 5à¬¸21à¬¸ àµŒ
à¬¼
à¬¸à¬¸ 5à¬¸21à¬¸ àµŒ 8508543750
2 TheÂ numberÂ ofÂ wordsÂ withÂ 5Â vowelsÂ isÂ ğ¶ 85 5à¬¹21à¬· àµŒ
à¬¼
à¬¹à¬· 5à¬¹21à¬· àµŒ 1620675000
AnswerÂ Â 8508543750+1620675000Â =Â 10129218750
21
Exercise
TheÂ numbersÂ ğ¶áˆºğ‘› ğ‘–áˆ» areÂ calledÂ binomialÂ coefficients becauseÂ theyÂ 
appearÂ asÂ theÂ coefficientsÂ inÂ theÂ expansionÂ ofÂ theÂ ğ‘›â€th powerÂ ofÂ 
theÂ binomialÂ ğ‘¥ àµ… ğ‘¦
BinomialÂ TheoremÂ LetÂ ğ‘› beÂ aÂ positiveÂ integerÂ ThenÂ forÂ allÂ ğ‘¥ andÂ ğ‘¦
àµŒ à· ğ‘›
ğ‘–
ğ‘¥à¯œğ‘¦à¯¡à¬¿à¯œ
à¯¡
à¯œà­€à¬´
ProofÂ EitherÂ byÂ inductionÂ onÂ nÂ orÂ useÂ aÂ combinatorialÂ argument
22
BinomialÂ Coefficients
ğ‘¥ àµ… ğ‘¦ à¯¡ àµŒ ğ‘›
0 ğ‘¦à¯¡ àµ… ğ‘›
1 ğ‘¥ğ‘¦à¯¡à¬¿à¬µ àµ… ğ‘›
2 ğ‘¥à¬¶ğ‘¦à¯¡à¬¿à¬¶ àµ… â‹¯ àµ… ğ‘›
ğ‘› ğ‘¥à¯¡
21
22
272024
12
TheoremÂ Pascalâ€™sÂ formulaÂ ForÂ integerÂ ğ‘› andÂ ğ‘˜ withÂ 1 àµ‘ ğ‘˜ àµ ğ‘›
ğ¶ ğ‘› ğ‘˜ àµŒ ğ¶ ğ‘› àµ† 1 ğ‘˜ àµ† 1 àµ… ğ¶áˆºğ‘› àµ† 1 ğ‘˜áˆ»
23
Pascalâ€™sÂ Triangle
ProofÂ ByÂ inductionÂ onÂ n orÂ byÂ combinatorialÂ argumentÂ partitionÂ 1â€¦nÂ 
intoÂ twoÂ subsetsÂ dependingÂ onÂ whetherÂ theyÂ containÂ n orÂ not andÂ applyÂ 
theÂ AdditionÂ Rule
WhenÂ theÂ coefficientsÂ areÂ computedÂ bottomâ€upÂ usingÂ Pascalâ€™sÂ formulaÂ 
andÂ displayedÂ forÂ increasingÂ valuesÂ ofÂ nÂ oneÂ rowÂ perÂ valueÂ ofÂ n theÂ 
resultingÂ diagramÂ isÂ calledÂ Pascalâ€™sÂ TriangleÂ appearingÂ inÂ BlaiseÂ Pascalâ€™sÂ 
TraitÃ© duÂ triangleÂ arithmÃ©tique 1653
TraitÃ© duÂ triangleÂ arithmÃ©tique 1653
24
23
24
272024
13
Pascalâ€™sÂ Triangle
25
ğ‘›
ğ‘˜ àµŒ
ğ‘› àµ† 1
ğ‘˜ àµ† 1
àµ… ğ‘› àµ† 1
ğ‘˜
ExerciseÂ CanÂ youÂ provideÂ aÂ combinatorialÂ proofÂ ofÂ thisÂ identity
â€¢ WhatÂ otherÂ propertiesÂ canÂ youÂ find
AÂ FewÂ BinomialÂ Identities
26
1áˆ»   ğ‘›
ğ‘˜
àµŒ ğ‘›
ğ‘˜
ğ‘› àµ† 1
ğ‘˜ àµ† 1
2áˆ»    2à¯¡ àµŒ ğ‘›
0 àµ… ğ‘›
1 àµ… ğ‘›
2 àµ… â‹¯ àµ…
ğ‘›
ğ‘› àµ† 1 àµ… ğ‘›
ğ‘›
3áˆ»  ğ‘›
1 àµ… ğ‘›
3 àµ… ğ‘›
5 àµ… â‹¯ àµŒ ğ‘›
0 àµ… ğ‘›
2 àµ… ğ‘›
4 àµ… â‹¯
4áˆ»    ğ‘›2à¯¡à¬¿à¬µ àµŒ 1 ğ‘›
1 àµ… 2 ğ‘›
2 àµ… 3 ğ‘›
3 â‹¯ àµ… ğ‘› ğ‘›
ğ‘›
5áˆ»   2ğ‘›
ğ‘›
àµŒ à· ğ‘›
ğ‘˜
à¬¶
à¯¡
à¯à­€à¬´
25
26
272024
14
â€¢ IfÂ ğ‘† isÂ aÂ multisetÂ anÂ ğ‘Ÿâ€permutation ofÂ ğ‘† isÂ anÂ orderedÂ arrangementÂ ofÂ 
ğ‘Ÿ ofÂ theÂ elementsÂ ofÂ ğ‘†
â€¢ IfÂ  ğ‘† àµŒ ğ‘›Â anÂ ğ‘›â€permutationÂ isÂ simplyÂ calledÂ aÂ permutation ofÂ ğ‘†
27
PermutationsÂ ofÂ multisets
Example IfÂ ğ‘† àµŒ 2 Â· ğ‘ 1 Â· ğ‘ 3 Â· ğ‘ thenÂ acbc andÂ cbcc areÂ 4â€permutationsÂ 
ofÂ ğ‘† whileÂ abccca isÂ aÂ permutationÂ ofÂ ğ‘†
Theorem LetÂ ğ‘† beÂ aÂ multisetÂ withÂ anÂ unlimitedÂ supplyÂ ofÂ eachÂ ofÂ ğ‘˜
distinctÂ objectsÂ ThenÂ theÂ numberÂ ofÂ ğ‘Ÿâ€permutationsÂ ofÂ SÂ isÂ ğ‘˜à¯¥
TheoremÂ LetÂ ğ‘† beÂ aÂ multisetÂ ofÂ sizeÂ ğ‘› consistingÂ ofÂ ğ‘˜ distinctÂ elementsÂ 
withÂ finiteÂ repetitionÂ countsÂ ğ‘›à¬µ ğ‘›à¬¶ â€¦  ğ‘›à¯Â LetÂ ğ‘› àµŒ ğ‘›à¬µ àµ… ğ‘›à¬¶ àµ… â‹¯ àµ… ğ‘›à¯Â 
ThenÂ theÂ numberÂ ofÂ permutationsÂ ofÂ ğ‘† equals
28
PermutationsÂ ofÂ multisetsâ€¦
ExampleÂ TheÂ numberÂ ofÂ permutationsÂ ofÂ theÂ lettersÂ inÂ theÂ wordÂ 
MISSISSIPPI isÂ theÂ sameÂ asÂ theÂ numberÂ ofÂ permutationsÂ ofÂ theÂ multisetÂ 
1 â‹… ğ‘€ 4 â‹… ğ¼ 4 â‹… ğ‘† 2 â‹… ğ‘ƒ Â whichÂ equalsÂ 11áˆº1 4 4 2áˆ»
ğ‘›
ğ‘›à¬µ ğ‘›à¬¶ â‹¯ ğ‘›à¯
27
28
272024
15
â€¢ AÂ secretaryÂ worksÂ inÂ aÂ buildingÂ locatedÂ 9Â 
blocksÂ eastÂ andÂ 7Â blocksÂ northÂ ofÂ hisÂ homeÂ 
EveryÂ dayÂ heÂ walksÂ theÂ 16Â blocksÂ toÂ workÂ 
HeÂ promisedÂ toÂ himselfÂ thatÂ heÂ wouldÂ 
retireÂ onceÂ heÂ hasÂ triedÂ everyÂ singleÂ 
shortestÂ routeÂ WhenÂ wouldÂ thatÂ beÂ 
29
Example
SolutionÂ AÂ validÂ pathÂ canÂ beÂ viewedÂ asÂ aÂ permutationÂ ofÂ theÂ 
multisetÂ ğ‘† àµŒ 9 Â· ğ¸ 7 Â· ğ‘ Â ThereforeÂ thereÂ areÂ 16áˆº9 7áˆ» àµŒ
11440Â AtÂ 251Â workÂ daysÂ perÂ yearÂ exploringÂ allÂ wouldÂ takeÂ 
4558Â years
home
work
â€¢ ConsiderÂ theÂ productÂ ofÂ threeÂ matricesÂ ğ´Â ğµÂ ğ¶Â ofÂ sizesÂ 10àµˆ100Â 100àµˆ5Â 
andÂ 5àµˆ50Â respectively
â€¢ WhichÂ oneÂ ofÂ 
ğ´ğµ ğ¶ orÂ asÂ  ğ´ ğµğ¶
requiresÂ fewerÂ scalarÂ 
multiplicationsÂ Â DoesÂ itÂ matterÂ 
ï€­TheÂ numberÂ ofÂ scalarÂ multiplicationsÂ isÂ 5000Â +Â 2500Â =7500Â forÂ 
ğ´ğµ ğ¶ Â 
andÂ 25000Â +Â 50000Â =75000Â forÂ  ğ´ ğµğ¶
â€¢ MoreÂ generallyÂ whenÂ multiplyingÂ ğ‘› matricesÂ inÂ whatÂ orderÂ shouldÂ theÂ 
partialÂ productsÂ beÂ computed
30
MatrixÂ ChainÂ Multiplication
â€¢ NumberÂ ofÂ waysÂ ğ‘ƒáˆºğ‘›áˆ»
toÂ performÂ theÂ product
ğ‘ƒ ğ‘› àµŒ á‰
1                                     if ğ‘› àµŒ 1
à·
ğ‘ƒáˆºğ‘˜áˆ»ğ‘ƒáˆºğ‘› àµ† ğ‘˜áˆ»
à¯¡à¬¿à¬µ
à¯à­€à¬µ
 if ğ‘› àµ’ 2
29
30
272024
16
3 HowÂ manyÂ differentÂ binaryÂ searchÂ treesÂ canÂ beÂ builtÂ onÂ aÂ setÂ ofÂ keysÂ Â Â 
ğ‘¥à¬µ àµ ğ‘¥à¬¶ àµ â‹¯ àµ ğ‘¥à¯¡
1 GivenÂ matricesÂ ğ´à¬µ ğ´à¬¶ â€¦  ğ´à¯¡Â inÂ whatÂ orderÂ shouldÂ theÂ partialÂ productsÂ beÂ 
computedÂ HowÂ manyÂ differentÂ choicesÂ areÂ thereÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
áˆºğ´à¬µáˆºğ´à¬¶áˆºğ´à¬·ğ´à¬¸áˆ»áˆ»áˆ» ğ´à¬µ
ğ´à¬¶ğ´à¬· ğ´à¬¸
 áˆº ğ´à¬µğ´à¬¶  áˆºğ´à¬·ğ´à¬¸áˆ»áˆ» áˆº
ğ´à¬µğ´à¬¶ ğ´à¬· ğ´à¬¸áˆ»
ğ´à¬µ ğ´à¬¶ğ´à¬·
ğ´à¬¸
2 GivenÂ aÂ regularÂ gridÂ howÂ manyÂ differentÂ shortestÂ pathsÂ areÂ thereÂ fromÂ 00Â 
toÂ áˆºğ‘› ğ‘›áˆ» thatÂ remainÂ belowÂ theÂ lineÂ ğ‘¦ àµŒ ğ‘¥ 
31
FourÂ RelatedÂ Problems
4 WhatÂ isÂ theÂ numberÂ ofÂ triangulationsÂ ofÂ aÂ convexÂ áˆº2 àµ… ğ‘›áˆ»â€polygon
32
ğ‘› àµŒ 4
ğ‘› àµŒ 1
ğ‘› àµŒ 2
ğ‘› àµŒ 3
TriangulationsÂ ofÂ  ğ’ àµ… ğŸ â€gon
ğ´à¬µğ´à¬¶
ğ’ applicationsÂ ofÂ aÂ binaryÂ operator
ğ‘› àµŒ 1
ğ´à¬µ ğ´à¬¶ğ´à¬·
   
ğ´à¬µğ´à¬¶ ğ´à¬·
ğ‘› àµŒ 2
ğ´à¬µ ğ´à¬¶ ğ´à¬·ğ´à¬¸
 ğ´à¬µ
ğ´à¬¶ğ´à¬· ğ´à¬¸
 
ğ´à¬µğ´à¬¶
ğ´à¬·ğ´à¬¸
ğ´à¬µ ğ´à¬¶ğ´à¬·
ğ´à¬¸   
ğ´à¬µğ´à¬¶ ğ´à¬· ğ´à¬¸
ğ‘› àµŒ 3
ğ´à¬µğ´à¬¶ ğ´à¬· ğ´à¬¸ ğ´à¬¹   
ğ´à¬µ ğ´à¬¶ğ´à¬·
ğ´à¬¸ ğ´à¬¹   
ğ´à¬µğ´à¬¶
ğ´à¬·ğ´à¬¸ ğ´à¬¹
 
ğ´à¬µ
ğ´à¬¶ğ´à¬· ğ´à¬¸
ğ´à¬¹   
ğ´à¬µ ğ´à¬¶ğ´à¬·
ğ´à¬¸ğ´à¬¹
 ğ´à¬µ
ğ´à¬¶ ğ´à¬·ğ´à¬¸
ğ´à¬¹
ğ´à¬µ
ğ´à¬¶ğ´à¬· ğ´à¬¸ ğ´à¬¹
  ğ´à¬µ
ğ´à¬¶ğ´à¬·
ğ´à¬¸ğ´à¬¹
 ğ´à¬µ ğ´à¬¶
ğ´à¬·ğ´à¬¸ ğ´à¬¹
ğ´à¬µğ´à¬¶
ğ´à¬· ğ´à¬¸ğ´à¬¹
  
ğ´à¬µğ´à¬¶ ğ´à¬·
ğ´à¬¸ğ´à¬¹
 ğ´à¬µ ğ´à¬¶ ğ´à¬· ğ´à¬¸ğ´à¬¹
ğ´à¬µğ´à¬¶
ğ´à¬·ğ´à¬¸
ğ´à¬¹   
ğ´à¬µ ğ´à¬¶ ğ´à¬·ğ´à¬¸
ğ´à¬¹
ğ‘› àµŒ 4
ğ‘› àµŒ 1
ğ‘› àµŒ 2
ğ‘› àµŒ 3
ğ‘› àµŒ 4
BSTÂ forÂ ğ’ keys
ğ‘› àµŒ 1
ğ‘› àµŒ 2
ğ‘› àµŒ 3
ShortestÂ pathÂ inÂ ğ’ àµˆ ğ’ grid
ğ‘› àµŒ 4
31
32
272024
17
â€¢ Nonâ€crossingÂ partitionsÂ ofÂ n items
â€¢ ConcurrentÂ handshakesÂ ofÂ ğ’ pairsÂ people
33
AndÂ TwoÂ Moreâ€¦
â€¢ GoalÂ Â ofÂ shortestÂ pathsÂ fromÂ áˆº00áˆ» toÂ áˆºğ‘› ğ‘›áˆ» thatÂ avoidsÂ locationsÂ 
aboveÂ theÂ lineÂ ğ‘¦ àµŒ ğ‘¥
â€¢ AÂ pathÂ canÂ beÂ viewedÂ asÂ aÂ von Dyck wordÂ ofÂ lengthÂ 2ğ‘›Â ieÂ aÂ 
permutationÂ ofÂ  ğ‘› Â· ğ¸ ğ‘› Â· ğ‘ whoseÂ prefixesÂ containÂ atÂ leastÂ asÂ manyÂ 
ğ¸â€™sÂ asÂ ğ‘â€™sÂ ieÂ atÂ allÂ timesÂ ğ¸â€™s àµ’ ğ‘â€™s
34
ShortestÂ ConstrainedÂ PathsÂ onÂ aÂ Grid
33
34
272024
18
â€¢ Notation
ğ‘ˆà¯ à¯¡ setÂ ofÂ unconstrainedÂ pathsÂ fromÂ áˆº00áˆ» toÂ áˆºğ‘š ğ‘›áˆ»
ğ¶à¯¡à¯¡ setÂ ofÂ validÂ constrainedÂ pathsÂ fromÂ áˆº00áˆ» toÂ áˆºğ‘› ğ‘›áˆ»
ğ¼à¯¡à¯¡ setÂ ofÂ invalidÂ constrainedÂ pathsÂ fromÂ áˆº00áˆ» toÂ áˆºğ‘› ğ‘›áˆ»
â€¢ AnswerÂ canÂ beÂ easilyÂ computedÂ ifÂ weÂ knowÂ theÂ numberÂ ofÂ invalidÂ paths
35
ShortestÂ ConstrainedÂ Pathsâ€¦
Â validÂ pathsÂ àµŒ Â unconstrainedÂ pathsÂ àµ† Â invalidÂ pathsÂ ie
ğ¶à¯¡à¯¡ àµŒ ğ‘ˆà¯¡à¯¡ àµ† ğ¼à¯¡à¯¡
â€¢ WeÂ establishÂ aÂ bijectionÂ ğ‘“ ğ¼à¯¡à¯¡
ğ‘ˆà¯¡à¬¿à¬µà¯¡à¬¾à¬µ andÂ useÂ theÂ BijectionÂ RuleÂ 
toÂ findÂ  ğ¼à¯¡à¯¡
â€¢ OurÂ bijectionÂ ğ‘“ transformsÂ anÂ invalidÂ pathÂ byÂ flippingÂ everyÂ symbolÂ 
after theÂ firstÂ violation
ExampleÂ WithÂ ğ‘› àµŒ 5Â theÂ pathÂ ENNNEEENNE becomesÂ ENNENNNEEN
â€¢ InÂ generalÂ anÂ invalidÂ pathÂ toÂ  ğ‘› ğ‘› becomesÂ anÂ unconstrainedÂ pathÂ 
toÂ  ğ‘› àµ† 1 ğ‘› àµ… 1
Exercise VerifyÂ 1Â ifÂ ğ‘¥ âˆˆ ğ¼à¯¡à¯¡ thenÂ ğ‘“ ğ‘¥ âˆˆ ğ‘ˆà¯¡à¬¿à¬µà¯¡Â 2Â f isÂ oneâ€toâ€oneÂ andÂ 
3Â fÂ isÂ onto
36
AÂ UsefulÂ Transformation
TheoremÂ  ğ¶à¯¡à¯¡ àµŒ ğ‘ˆà¯¡à¯¡ àµ† ğ¼à¯¡à¯¡ àµŒ
à¬¶à¯¡ 
à¯¡à¯¡ àµ†
à¬¶à¯¡ 
à¯¡à¬¿à¬µ  à¯¡à¬¾à¬µ  àµŒ
à®¼áˆºà¬¶à¯¡à¯¡áˆ»
à¯¡à¬¾à¬µ
35
36
272024
19
â€¢ TheÂ CatalanÂ numbersÂ areÂ definedÂ byÂ theÂ sequence
37
CatalanÂ Numbers
ğ¶à¯¡ àµŒ
1
ğ‘› àµ… 1
2ğ‘›
ğ‘›
àµŒ à·‘ ğ‘› àµ… ğ‘–
ğ‘–
à¯¡
à¯œà­€à¬¶
 ğ‘› àµŒ 012 â€¦
â€¢ TheÂ firstÂ fewÂ areÂ 1Â 1Â 2Â 5Â 14Â 42Â 132Â 429Â 1430Â 4862Â 16796Â 58786Â 
208012Â 742900Â 2674440Â 9694845 â€¦
â€¢ NamedÂ afterÂ theÂ BelgianÂ mathematicianÂ EugÃ¨ne CatalanÂ 1814â€1894Â 
whoÂ usedÂ themÂ toÂ expressÂ theÂ numberÂ ofÂ groupingÂ ğ‘› applicationsÂ ofÂ 
anÂ associativeÂ binaryÂ operator
â€¢ WeÂ withÂ toÂ showÂ thatÂ ğ‘ƒ ğ‘› àµŒ ğ¶à¯¡à¬¿à¬µ where
38
MatrixÂ ChainsÂ Revisited
ğ‘ƒ ğ‘› àµŒ á‰
1                                     if ğ‘› àµŒ 1
à·
ğ‘ƒáˆºğ‘˜áˆ»ğ‘ƒáˆºğ‘› àµ† ğ‘˜áˆ»
à¯¡à¬¿à¬µ
à¯à­€à¬µ
 if ğ‘› àµ’ 2
â€¢ WeÂ establishÂ aÂ bijectionÂ betweenÂ constrainedÂ pathsÂ andÂ possibleÂ 
orderingÂ ofÂ ğ‘› àµ† 1 applicationsÂ ofÂ aÂ binaryÂ operatorÂ matrixÂ multiplication
37
38
272024
20
â€¢ LetÂ ğ‘à¯¡ denoteÂ theÂ numberÂ ofÂ distinctÂ binaryÂ searchÂ treesÂ onÂ ğ‘›
keysÂ ProveÂ thatÂ ğ‘à¯¡ àµŒ ğ¶à¯¡
39
Exercise
â€¢ ğ‘Ÿâ€permutationsÂ ofÂ ğ‘› elements
40
SummaryÂ soÂ far
ğ‘ƒáˆºğ‘› ğ‘Ÿáˆ» àµŒ
ğ‘›
ğ‘› àµ† ğ‘Ÿ 
ğ‘ƒáˆºğ‘› ğ‘Ÿáˆ»
ğ‘Ÿ
àµŒ
ğ‘›
ğ‘Ÿ ğ‘› àµ† ğ‘Ÿ 
â€¢ CircularÂ ğ‘Ÿâ€permutationsÂ ofÂ ğ‘› elements
â€¢ ğ‘Ÿâ€combinationsÂ ofÂ ğ‘› elements
ğ¶ ğ‘› ğ‘Ÿ àµŒ ğ‘›
ğ‘Ÿ
àµŒ
ğ‘›
ğ‘Ÿ ğ‘› àµ† ğ‘Ÿ 
ğ‘˜à¯¥
â€¢ ğ‘Ÿâ€permutationsÂ ofÂ multisetÂ withÂ unlimitedÂ supplyÂ ofÂ ğ‘˜ classes
ğ‘›
ğ‘›à¬µ ğ‘›à¬¶ â‹¯ ğ‘›à¯
â€¢ IfÂ theÂ ğ‘˜ classesÂ haveÂ repetitionÂ countsÂ ğ‘›à¬µ â€¦  ğ‘›à¯ withÂ ğ‘› àµŒ âˆ‘ğ‘›à¯œ
ğ¶à¯¡ àµŒ
1
ğ‘› àµ… 1
2ğ‘›
ğ‘›
â€¢ ğ‘›â€th CatalanÂ number
39
40
272024
21
â€¢ OrderÂ unimportantÂ repetitionsÂ allowed
ExampleÂ  1343117
41
CombinationsÂ ofÂ multisets
â€¢ IfÂ ğ‘† isÂ aÂ multisetÂ thenÂ anÂ ğ‘Ÿâ€combinationÂ ofÂ ğ‘† isÂ anÂ unorderedÂ 
selectionÂ ofÂ ğ‘Ÿ ofÂ theÂ elementsÂ ofÂ ğ‘†
ï€­ThusÂ anÂ ğ‘Ÿâ€combinationÂ isÂ itselfÂ aÂ multiset
ï€­IfÂ ğ‘† hasÂ ğ‘› elementsÂ thenÂ thereÂ isÂ onlyÂ oneÂ ğ‘›â€combinationÂ ofÂ ğ‘†Â namelyÂ 
ğ‘† itself
ï€­IfÂ ğ‘† containsÂ ğ‘˜ distinct elementsÂ thenÂ thereÂ areÂ ğ‘˜ 1â€combinationsÂ ofÂ ğ‘†
ExampleÂ IfÂ ğ‘† àµŒ áˆ¼2 â‹… ğ‘ 1 â‹… ğ‘ 3 â‹… ğ‘áˆ½ thenÂ theÂ followingÂ areÂ allÂ theÂ 2â€
combinationsÂ ofÂ ğ‘†Â  ğ‘ ğ‘ Â  ğ‘ ğ‘ Â  ğ‘ ğ‘ Â  ğ‘ ğ‘ Â andÂ  ğ‘ ğ‘
TheoremÂ LetÂ ğ‘† beÂ aÂ multisetÂ withÂ ğ‘˜ distinctÂ objectÂ typesÂ eachÂ withÂ 
unlimitedÂ multiplicityÂ ThenÂ theÂ numberÂ ofÂ ğ‘Ÿâ€combinationsÂ ofÂ ğ‘† isÂ 
ğ¶áˆºğ‘˜ àµ† 1 àµ… ğ‘Ÿ ğ‘Ÿáˆ»
42
ProofÂ LetÂ theÂ distinctÂ objectsÂ ofÂ S beÂ ğ‘à¬µ ğ‘à¬¶ â€¦  ğ‘à¯Â AnÂ râ€combinationÂ hasÂ theÂ formÂ 
ğ‘¥à¬µ Â· ğ‘à¬µ ğ‘¥à¬¶ Â· ğ‘à¬¶ â€¦  ğ‘¥à¯ğ‘à¯
whereÂ ğ‘¥à¯œ âˆˆ â„• andÂ ğ‘¥à¬µ àµ… ğ‘¥à¬¶ àµ… â‹¯ àµ… ğ‘¥à¯ àµŒ ğ‘Ÿ
ThusÂ thereÂ isÂ aÂ 1â€1Â correspondenceÂ betweenÂ theÂ râ€combinationsÂ andÂ nonâ€negativeÂ 
integerÂ solutionsÂ toÂ ğ‘¥à¬µ àµ… ğ‘¥à¬¶ àµ… â‹¯ àµ… ğ‘¥à¯ àµŒ ğ‘ŸÂ 
ThisÂ isÂ theÂ sameÂ asÂ theÂ numberÂ ofÂ permutationsÂ ofÂ theÂ setÂ ğ‘‡ àµŒ
ğ‘˜ àµ† 1 Â· 0 ğ‘Ÿ Â· 1 Â 
TheÂ 0â€™sÂ divideÂ theÂ 1â€™sÂ intoÂ k groupsÂ ofÂ 1â€™sÂ TheÂ sizeÂ ofÂ theÂ ğ‘–â€th groupÂ isÂ theÂ valueÂ ofÂ ğ‘¥à¯œ
Example AssumingÂ ğ‘˜ àµŒ 4 ğ‘Ÿ àµŒ 5Â theÂ permutationÂ ofÂ  3 Â· 05 Â· 1 givenÂ byÂ 01110011Â 
correspondsÂ toÂ theÂ solutionÂ ğ‘¥à¬µ àµŒ 0 ğ‘¥à¬¶ àµŒ 3 ğ‘¥à¬· àµŒ 0 ğ‘¥à¬¸ àµŒ 2Â aÂ solutionÂ toÂ ğ‘¥à¬µ àµ… ğ‘¥à¬¶ àµ…
ğ‘¥à¬· àµ… ğ‘¥à¬¸ àµŒ 5
ThusÂ theÂ numberÂ ofÂ râ€combinationsÂ ofÂ ğ‘† isÂ theÂ sameÂ asÂ theÂ numberÂ ofÂ permutationsÂ 
ofÂ ğ‘‡Â ieÂ ğ¶áˆºğ‘˜ àµ† 1 àµ… ğ‘Ÿ ğ‘Ÿáˆ»
41
42
272024
22
â€¢ AÂ bakeryÂ offersÂ 8Â varietiesÂ ofÂ doughnutsÂ IfÂ aÂ boxÂ containsÂ 1Â dozenÂ 
howÂ manyÂ differentÂ boxesÂ canÂ youÂ buy
â€¢ AÂ sequenceÂ ğ‘¥à¬µ ğ‘¥à¬¶ ğ‘¥à¬· â€¦ isÂ monotonicallyÂ increasingÂ ifÂ ğ‘¥à¯œà¬¿à¬µ àµ‘ ğ‘¥à¯œ forÂ allÂ 
ğ‘–Â WhatÂ isÂ theÂ numberÂ ofÂ monotonicallyÂ increasingÂ sequencesÂ ofÂ 
lengthÂ 12Â whoseÂ termsÂ areÂ takenÂ fromÂ  123 â€¦  8 
43
Exercises
44
TheoremÂ LetÂ ğ‘† beÂ aÂ multisetÂ withÂ kÂ distinctÂ objectÂ typesÂ eachÂ withÂ 
unlimitedÂ multiplicityÂ ThenÂ theÂ numberÂ ofÂ ğ‘Ÿâ€combinationsÂ ofÂ ğ‘† inÂ whichÂ 
eachÂ ofÂ theÂ ğ‘˜ differentÂ typesÂ occursÂ atÂ leastÂ onceÂ equalsÂ ğ¶áˆºğ‘Ÿ àµ† 1 ğ‘˜ àµ† 1áˆ»
ProofÂ 
WeÂ seekÂ theÂ numberÂ ofÂ solutionsÂ toÂ ğ‘¥à¬µ àµ… ğ‘¥à¬¶ àµ… â‹¯ àµ… ğ‘¥à¯¡ àµŒ ğ‘Ÿ withÂ positiveÂ integers
TakeÂ aÂ sequenceÂ ofÂ ğ‘Ÿ 1â€™sÂ andÂ letÂ theÂ ğ‘Ÿ àµ† 1 positionsÂ betweenÂ theÂ 1â€™sÂ beÂ ğ‘‡ àµŒ áˆ¼ğ‘à¬µ â€¦  ğ‘à¯¥à¬¿à¬µáˆ½
ThenÂ theÂ numberÂ ofÂ solutionsÂ soughtÂ isÂ theÂ numberÂ ofÂ áˆºğ‘˜ àµ† 1áˆ»â€combinationsÂ ofÂ ğ‘‡
ChooseÂ aÂ combinationÂ andÂ insertÂ aÂ 0 inÂ eachÂ ofÂ theÂ chosenÂ ğ‘à¯œâ€™sÂ TheÂ numberÂ ofÂ 1â€™sÂ 
betweenÂ consecutiveÂ 0â€™sÂ isÂ strictlyÂ positiveÂ andÂ givesÂ theÂ numberÂ ofÂ repetitionsÂ ofÂ theÂ 
correspondingÂ objectÂ type
ThisÂ numberÂ equalsÂ ğ¶áˆºğ‘Ÿ àµ† 1 ğ‘˜ àµ† 1áˆ»Â asÂ claimedÂ Â âˆ
ExampleÂ IfÂ ğ‘Ÿ àµŒ 6 and ğ‘˜ àµŒ 4 then 110110101Â correspondsÂ toÂ theÂ solutionÂ 
ğ‘¥à¬µ àµŒ ğ‘¥à¬¶ àµŒ 2Â ğ‘¥à¬· àµŒ ğ‘¥à¬¸ àµŒ 1
43
44
272024
23
ProblemÂ GivenÂ ğ‘›Â generateÂ allÂ permutationsÂ ofÂ  1 â€¦  ğ‘›
â€¢ ComponentÂ ofÂ manyÂ algorithms
ï€­TheÂ basisÂ ofÂ manyÂ â€œbruteÂ forceâ€Â algorithms
ï‚§ ReasonableÂ forÂ smallÂ nÂ àµ‘ 20áˆ»
ï‚§ ProcessingÂ aÂ permutationÂ takesÂ longerÂ thanÂ generatingÂ it
ï€­StructuralÂ backboneÂ ofÂ backtrackingÂ algorithms
ï€­GetÂ usefulÂ insightÂ averageÂ worstÂ caseÂ behaviorÂ intoÂ algorithmsÂ forÂ 
variousÂ combinatorialÂ problems
ï‚§ SortingÂ spanningÂ forestÂ travelingÂ salesmanÂ etc
â€¢ MoreÂ thanÂ 30Â differentÂ algorithmsÂ haveÂ beenÂ published
45
GeneratingÂ Permutations
GoalÂ LowÂ averageÂ timeÂ perÂ permutationÂ lowÂ auxiliaryÂ memoryÂ 
requirementsÂ simpleÂ stateÂ allowsÂ youÂ toÂ generateÂ nextÂ permutation
â€¢ EvaluateÂ theÂ followingÂ withÂ respectÂ toÂ ourÂ goals
46
AlgorithmÂ 1
45
46
272024
24
ExerciseÂ WhyÂ isÂ theÂ algorithmÂ correct
47
AlgorithmÂ 2
â€¢ BasedÂ onÂ recursiveÂ definitionÂ ğ‘› àµŒ ğ‘› àµ† 1  Â· ğ‘›
ClaimÂ Â PermuteÂ requiresÂ àµ 2áˆºğ‘’ àµ† 1áˆ» swapsperm
â€¢ BasedÂ onÂ theÂ factÂ thatÂ deletingÂ anÂ elementÂ fromÂ aÂ permutationÂ ğœ‹ ofÂ 
áˆ¼1 â€¦  ğ‘›áˆ½ resultsÂ inÂ aÂ permutationÂ ğœ ofÂ áˆ¼1 â€¦  ğ‘› àµ† 1áˆ½
ï€­ ğ‘› differentÂ permutationsÂ ofÂ áˆ¼1 â€¦  ğ‘›áˆ½ resultÂ inÂ theÂ sameÂ permutationÂ ğœ
â€¢ BasicÂ IdeaÂ FixÂ anÂ arbitraryÂ elementÂ ğ‘¥Â ForÂ eachÂ  ğ‘› àµ† 1 â€permutationÂ ğœ‹
ofÂ theÂ remainingÂ elementsÂ generateÂ ğ‘› newÂ permutationsÂ byÂ insertingÂ 
ğ‘¥ inÂ allÂ possibleÂ positionsÂ ofÂ ğœ‹
ï€­StartingÂ withÂ theÂ singleÂ permutationÂ ofÂ 1Â theÂ algorithmÂ generatesÂ theÂ 
permutationsÂ ofÂ  1 â€¦  ğ‘› recursivelyÂ inÂ ğ‘› àµ† 1 rounds
ï€­Round ğ‘˜ àµŒ 2 â€¦  ğ‘› proceedsÂ byÂ listingÂ everyÂ permutationÂ ï° ofÂ 
1 â€¦  ğ‘˜ àµ† 1 andÂ insertingÂ ğ‘˜ intoÂ ï° atÂ eachÂ possibleÂ position
â€¢ OnlyÂ oneÂ swapÂ perÂ permutation
48
AlgorithmÂ 3
47
48
272024
25
AlgorithmÂ 3Â Example
49
RoundÂ 2Â writeÂ eachÂ permutationÂ ofÂ 1Â twiceÂ andÂ interlaceÂ 2
RoundÂ 3Â writeÂ eachÂ permutationÂ ofÂ Â áˆ¼12áˆ½ thriceÂ andÂ interlaceÂ 3
50
RoundÂ 4Â writeÂ eachÂ 
permutationÂ ofÂ 123Â fourÂ 
timesÂ andÂ interlaceÂ 4
ProsÂ 
â€¢
EachÂ permutationÂ requiresÂ 
onlyÂ 1Â swap
ConsÂ 
â€¢
findingÂ theÂ rightÂ swapÂ isÂ notÂ easy
â€¢
AÂ naÃ¯veÂ implementationÂ requiresÂ 
largeÂ amountsÂ ofÂ storage
49
50
272024
26
â€¢ InÂ orderÂ toÂ determineÂ theÂ nextÂ swapÂ eachÂ elementÂ isÂ 
assignedÂ anÂ â€œintendedâ€Â directionÂ ofÂ movementÂ egÂ 
2 6 3 1 5 4
â€¢ AnÂ elementÂ isÂ movable ifÂ itsÂ neighborÂ inÂ itsÂ intendedÂ 
directionÂ hasÂ aÂ smallerÂ valueÂ 
ï€­InÂ theÂ exampleÂ aboveÂ 6Â 3Â andÂ 5Â areÂ movable
ï€­ ElementÂ 1Â isÂ neverÂ movable
ï€­Element ğ‘› isÂ notÂ movableÂ ifÂ itÂ isÂ theÂ leftmostÂ respÂ rightmostÂ 
elementÂ andÂ pointsÂ toÂ theÂ leftÂ respÂ right
51
AnÂ efficientÂ implementation
1 OutputÂ 1 2 3 â€¦ ğ‘›
2 while someÂ elementÂ isÂ movableÂ do
a SwapÂ theÂ largestÂ movableÂ elementÂ ğ‘š withÂ theÂ neighborÂ itÂ pointsÂ to
b SwitchÂ theÂ intendedÂ directionÂ ofÂ allÂ integersÂ ğ‘ àµ ğ‘š
52
AnÂ efficientÂ implementationâ€¦
ExampleÂ IfÂ theÂ currentÂ permutationÂ isÂ 2 3 1 5 6 4Â theÂ nextÂ 
twoÂ areÂ 2 3 1 5 4 6 andÂ 2 3 1 4 5 6
ExerciseÂ WhatÂ dataÂ structuresÂ canÂ beÂ usedÂ toÂ keepÂ trackÂ ofÂ 
directionsÂ movableÂ elementsÂ andÂ forÂ choosingÂ theÂ pairÂ toÂ swap
51
52
272024
27
ExampleÂ ğ‘› àµŒ 4
53
2  3  1  4
2  3  4  1
2  4  3  1
4  2  3  1
4  2  1  3
2  4  1  3
2  1  4  3
2  1  3  4
3  1  2  4
3  1  4  2
3  4  1  2
4  3  1  2
4  3  2  1
3  4  2  1
3  2  4  1
3  2  1  4
1  2  3  4
1  2  4  3
1  4  2  3
4  1  2  3
4  1  3  2
1  4  3  2
1  3  4  2
1  3  2  4
â€¢ GeneratingÂ allÂ combinationsÂ ieÂ subsetsÂ ofÂ ğ‘† àµŒ 012 â€¦  ğ‘› àµ† 1
isÂ straightforwardÂ UsingÂ anÂ ğ‘›â€bitÂ vectorÂ ğ‘ àµŒ ğ‘à¯¡à¬¿à¬µ ğ‘à¯¡à¬¿à¬¶ â€¦  ğ‘à¬µ ğ‘à¬´
withÂ ğ‘à¯œ àµŒ 1 iffÂ ğ‘– âˆˆ ğ‘†Â eachÂ ofÂ theÂ 2à¯¡ possibleÂ bitÂ sequencesÂ canÂ beÂ 
interpretedÂ asÂ aÂ subsetÂ ofÂ ğ‘†
54
GeneratingÂ Combinations
ğ’‚ğŸ
ğ’‚ğŸ
ğ’‚ğŸ
0
0
0
âˆ…
1
0
0
ğŸ
0
1
0
ğŸ
1
1
0
ğŸ ğŸ
0
0
1
ğŸ
1
0
1
ğŸ ğŸ
0
1
1
ğŸ ğŸ
1
1
1
ğŸ ğŸ ğŸ
â€¢ Starting with ğ‘ àµŒ ğŸ 
generate all sequences by 
repeatedly incrementing 
a by 1 The case ğ‘› àµŒ 3 is 
illustrated on the right
53
54
272024
28
â€¢ WhenÂ ğ‘Ÿ àµ ğ‘›Â itÂ isÂ moreÂ efficientÂ toÂ generateÂ râ€combinationsÂ 
lexicographically
ï€­WeÂ areÂ makingÂ useÂ ofÂ aÂ totalÂ orderÂ onÂ theÂ setÂ ofÂ permutations
Example TheÂ 4â€combinationsÂ ofÂ ğ‘† àµŒ 1 â€¦  6
inÂ lexicographicÂ 
orderÂ are
55
GeneratingÂ râ€Combinations
56
GeneratingÂ râ€Combinations
ClaimÂ LetÂ ğ‘† àµŒ áˆ¼1 â€¦  ğ‘›áˆ½Â TheÂ firstÂ ğ‘Ÿâ€combinationÂ ofÂ ğ‘† inÂ lexicographicÂ 
order isÂ 1 2 â€¦  ğ‘ŸÂ andÂ theÂ lastÂ isÂ ğ‘› àµ† ğ‘Ÿ àµ… 1 ğ‘› àµ† ğ‘Ÿ àµ… 2 â€¦  ğ‘›Â LetÂ ğ´ àµŒ
ğ‘à¬µ ğ‘à¬¶ â€¦  ğ‘à¯¥ beÂ anÂ ğ‘Ÿâ€combinationÂ ofÂ ğ‘†Â differentÂ fromÂ theÂ lastÂ oneÂ 
LetÂ ğ‘— beÂ theÂ largestÂ integerÂ suchÂ thatÂ ğ‘à¯ àµ ğ‘› andÂ ğ‘à¯ àµ… 1 isÂ notÂ oneÂ ofÂ 
ğ‘à¯à¬¾à¬µ â€¦  ğ‘à¯¥ noÂ repetitionsÂ allowedÂ ThenÂ theÂ ğ‘Ÿâ€combinationÂ thatÂ 
followsÂ ğ´ inÂ lexicographicÂ orderÂ is
ğ‘à¬µ â€¦  ğ‘à¯à¬¿à¬µ ğ‘à¯ àµ… 1 ğ‘à¯ àµ… 2 â€¦  ğ‘à¯ àµ… áˆºğ‘Ÿ àµ† ğ‘— àµ… 1áˆ»
RemarkÂ ThisÂ resultÂ canÂ beÂ easilyÂ usedÂ toÂ deriveÂ anÂ algorithmÂ thatÂ 
systematicallyÂ generatesÂ allÂ ğ‘Ÿâ€combinationsÂ ofÂ ğ‘† àµŒ áˆ¼1 â€¦  ğ‘›áˆ½
RemarkÂ IfÂ weÂ combineÂ theÂ algorithmÂ forÂ generatingÂ ğ‘Ÿâ€combinationsÂ ofÂ anÂ 
ğ‘›â€elementÂ setÂ withÂ theÂ algorithmÂ forÂ generatingÂ permutationsÂ Â ofÂ aÂ setÂ weÂ 
obtainÂ anÂ algorithmÂ forÂ generatingÂ ğ‘Ÿâ€permutationsÂ ofÂ anÂ ğ‘›â€elementÂ set
55
56
272024
29
â€¢ DesignÂ anÂ efficientÂ algorithmÂ thatÂ generatesÂ aÂ permutationÂ ofÂ 
âŒ©12 â€¦  ğ‘›âŒª uniformlyÂ atÂ random
ï€­EachÂ ofÂ theÂ ğ‘› permutationsÂ shouldÂ beÂ equallyÂ likelyÂ toÂ beÂ selected
ï€­YouÂ mayÂ assumeÂ accessÂ toÂ aÂ functionÂ RANDINTab thatÂ generatesÂ aÂ 
randomÂ integerÂ betweenÂ a andÂ b
â€¢ HowÂ longÂ inÂ termsÂ ofÂ numberÂ ofÂ callsÂ toÂ RANDINTÂ doesÂ yourÂ 
algorithmÂ require
57
Exercise
â€¢ ExplainÂ howÂ theÂ followingÂ algorithmÂ works
58
Exercise
â€¢ HowÂ manyÂ timesÂ onÂ averageÂ doÂ youÂ callÂ theÂ randomÂ function
57
58
272024
30
â€¢ TechniqueÂ toÂ countÂ theÂ numberÂ ofÂ objectsÂ inÂ aÂ unionÂ ofÂ setsÂ 
indirectlyÂ byÂ countingÂ howÂ manyÂ areÂ notÂ inÂ theÂ union
ï€­UsefulÂ whenÂ directÂ countingÂ isÂ difficultÂ orÂ impossible
â€¢ BasisÂ forÂ manyÂ â€œfastâ€Â exponentialÂ algorithmsÂ forÂ NPâ€hardÂ problemsÂ 
suchÂ asÂ determiningÂ ifÂ aÂ graphÂ containsÂ aÂ HamiltonianÂ pathÂ orÂ 
whetherÂ ğ‘› itemsÂ ofÂ sizesÂ ğ‘ à¬µ ğ‘ à¬¶ â€¦  ğ‘ à¯¡ canÂ beÂ packedÂ intoÂ ğ‘˜ binsÂ ofÂ 
capacityÂ ğ¶ each
ï€­AlgorithmsÂ basedÂ onÂ inclusionâ€exclusionÂ needÂ toÂ considerÂ allÂ subsetsÂ ofÂ 
aÂ setÂ resultingÂ inÂ Î© 2à¯¡ operationsÂ 
ï€­ExpensiveÂ butÂ significantlyÂ fasterÂ thanÂ aÂ ğ›© ğ‘› algorithm
59
Inclusionâ€ExclusionÂ Principle
â€¢ SometimesÂ inÂ orderÂ toÂ findÂ howÂ manyÂ elementsÂ belongÂ toÂ aÂ setÂ ğ´Â itÂ isÂ 
easierÂ toÂ findÂ howÂ manyÂ doÂ not belongÂ toÂ ğ´
60
Motivation
Example Count the number of integers between 1 and 600 that are not 
divisible by 6
ğ‘† àµŒ 1 â€¦  600
ğ´ àµŒ integers in S not divisible by  6
ğ´Ì… àµŒ integers in S divisible by  6
A
ğ‘º
ğ´ àµŒ ğ‘† àµ† ğ´Ì…
ğ´ àµŒ ğ‘† àµ† ğ´Ì… àµŒ 600 àµ† 100 àµŒ 500
59
60
272024
31
LetÂ ğ‘† àµŒ allÂ polygonsÂ ğ´à¬µ àµŒ setÂ ofÂ trianglesÂ ğ´à¬¶=Â setÂ ofÂ redÂ polygonsÂ 
WeÂ wantÂ  ğ´à¬µ âˆª ğ´à¬¶ àµŒ ğ´à¬µ âˆ© ğ´à¬¶ 
61
Motivationâ€¦
ExampleÂ WeÂ haveÂ aÂ collectionÂ ğ‘† ofÂ ğ‘› àµŒ 100 polygonsÂ SupposeÂ thatÂ 35Â 
polygonsÂ areÂ trianglesÂ 40Â areÂ rectanglesÂ andÂ 25Â areÂ pentagonsÂ 
FurthermoreÂ supposeÂ thatÂ 30Â areÂ redÂ outÂ ofÂ whichÂ 9Â areÂ alsoÂ trianglesÂ 
HowÂ manyÂ polygonsÂ areÂ neitherÂ trianglesÂ norÂ red
àµŒ 100 àµ† 35 àµ… 30 àµ… 9 àµŒ 44
A1
A2
S
ğ´à¬µ âˆª ğ´à¬¶ àµŒ
ğ´à¬µ àµ… ğ´à¬¶
àµ† ğ´à¬µ âˆ© ğ´à¬¶
A1
A2
S
A3
ğ´à¬µ âˆ© ğ´à¬¶ âˆ© ğ´à¬· àµŒ ğ‘† àµ† áˆº|ğ´à¬µ| àµ… ğ´à¬¶ àµ… ğ´à¬· áˆ»
+1
+1
+1
+1
+1
+1
+1
+1
àµ…áˆº|ğ´à¬µ âˆ© ğ´à¬¶| àµ… ğ´à¬µ âˆ© ğ´à¬· àµ… ğ´à¬¶ âˆ© ğ´à¬· áˆ» àµ† ğ´à¬µ âˆ© ğ´à¬¶ âˆ© ğ´à¬·
61
62
272024
32
A1
A2
S
A3
ğ´à¬µ âˆ© ğ´à¬¶ âˆ© ğ´à¬· àµŒ ğ‘† àµ† áˆº|ğ´à¬µ| àµ… ğ´à¬¶ àµ… ğ´à¬· áˆ»
0
0
0
ï€­1
ï€ ï€­1
ï€ ï€­ 1
ï€ ï€­2
+1
àµ…áˆº|ğ´à¬µ âˆ© ğ´à¬¶| àµ… ğ´à¬µ âˆ© ğ´à¬· àµ… ğ´à¬¶ âˆ© ğ´à¬· áˆ» àµ† ğ´à¬µ âˆ© ğ´à¬¶ âˆ© ğ´à¬·
A1
A2
S
A3
ğ´à¬µ âˆ© ğ´à¬¶ âˆ© ğ´à¬· àµŒ ğ‘† àµ† áˆº|ğ´à¬µ| àµ… ğ´à¬¶ àµ… ğ´à¬· áˆ»
0
0
0
0
0
0
+1
+1
àµ…áˆº|ğ´à¬µ âˆ© ğ´à¬¶| àµ… ğ´à¬µ âˆ© ğ´à¬· àµ… ğ´à¬¶ âˆ© ğ´à¬· áˆ» àµ† ğ´à¬µ âˆ© ğ´à¬¶ âˆ© ğ´à¬·
63
64
272024
33
A1
A2
S
A3
ğ´à¬µ âˆ© ğ´à¬¶ âˆ© ğ´à¬· àµŒ ğ‘† àµ† áˆº|ğ´à¬µ| àµ… ğ´à¬¶ àµ… ğ´à¬· áˆ»
0
0
0
0
0
0
0
+1
àµ…áˆº|ğ´à¬µ âˆ© ğ´à¬¶| àµ… ğ´à¬µ âˆ© ğ´à¬· àµ… ğ´à¬¶ âˆ© ğ´à¬· áˆ» àµ† ğ´à¬µ âˆ© ğ´à¬¶ âˆ© ğ´à¬·
ğ´à¬µ âˆª ğ´à¬¶ âˆª ğ´à¬· àµŒ áˆº|ğ´à¬µ| àµ… ğ´à¬¶ àµ… ğ´à¬· áˆ»
àµ†áˆº|ğ´à¬µ âˆ© ğ´à¬¶| àµ… ğ´à¬µ âˆ© ğ´à¬· àµ… ğ´à¬¶ âˆ© ğ´à¬· áˆ» àµ… ğ´à¬µ âˆ© ğ´à¬¶ âˆ© ğ´à¬·
â€¢ MoreÂ generallyÂ letÂ ğ‘à¬µ â€¦  ğ‘à¯§ beÂ ğ‘¡ propertiesconditionsÂ whichÂ eachÂ objectÂ inÂ ğ‘†
mayÂ orÂ mayÂ notÂ satisfyÂ LetÂ ğ´à¯œ denoteÂ theÂ subsetÂ ofÂ objectsÂ ofÂ ğ‘† whichÂ satisfyÂ 
conditionÂ ğ‘– andÂ possiblyÂ someÂ ofÂ theÂ otherÂ conditionsÂ asÂ wellÂ TheÂ followingÂ 
theoremÂ tellsÂ usÂ howÂ manyÂ objectsÂ satisfyÂ none ofÂ theÂ conditions
66
Generalization
Theorem
whereÂ theÂ firstÂ sumÂ isÂ overÂ allÂ 1â€combinationsÂ theÂ secondÂ isÂ overÂ allÂ Â 2â€
combinationsÂ theÂ thirdÂ overÂ allÂ 3â€combinationsÂ ofÂ áˆ¼1 â€¦  ğ‘¡áˆ½Â andÂ soÂ on
ğ´à¬µ âˆ© ğ´à¬¶ âˆ© â‹¯ âˆ© ğ´à¯§ àµŒ ğ‘† àµ† à· ğ´à¯œ àµ…
à·
ğ´à¯œ âˆ© ğ´à¯ àµ†
à¬µà®¸à¯œà®´à¯à®¸à¯§
à¬µà®¸à¯œà®¸à¯§
à·
ğ´à¯œ âˆ© ğ´à¯ âˆ© ğ´à¯ àµ… â‹¯ àµ… àµ†1 à¯§ ğ´à¬µ âˆ© â‹¯ âˆ© ğ´à¯§
à¬µà®¸à¯œà®´à¯à®´à¯à®¸à¯§
65
66
272024
34
CorollaryÂ TheÂ numberÂ ofÂ objectsÂ ofÂ ğ‘† whichÂ satisfyÂ atÂ leastÂ oneÂ ofÂ theÂ 
conditionsÂ ğ‘à¬µ â€¦  ğ‘à¯§ isÂ givenÂ by
67
Generalizationâ€¦
InÂ otherÂ wordsÂ theÂ sizeÂ  ğ´à¬µ âˆª ğ´à¬¶ âˆª â‹¯ âˆª ğ´à¯§ ofÂ aÂ unionÂ ofÂ setsÂ isÂ computedÂ asÂ 
followsÂ addÂ upÂ theÂ sizesÂ ofÂ allÂ theÂ individualÂ setsÂ theÂ subtractÂ theÂ sizesÂ ofÂ allÂ 
pairwiseÂ intersectionsÂ nowÂ addÂ theÂ sizesÂ ofÂ allÂ 3â€wayÂ intersectionsÂ thenÂ 
subtractÂ theÂ sizesÂ ofÂ allÂ 4â€wayÂ intersectionsÂ andÂ soÂ on
InÂ theÂ lastÂ stepÂ eitherÂ addÂ forÂ ğ‘¡ oddÂ orÂ subtractÂ forÂ ğ‘¡ evenÂ theÂ sizeÂ ofÂ theÂ 
intersectionÂ ofÂ allÂ theÂ ğ‘¡ sets
ğ´à¬µ âˆª ğ´à¬¶ âˆª â‹¯ âˆª ğ´à¯§ àµŒ à· ğ´à¯œ àµ†
à·
ğ´à¯œ âˆ© ğ´à¯ àµ…
à¬µà®¸à¯œà®´à¯à®¸à¯§
à¬µà®¸à¯œà®¸à¯§
à·
ğ´à¯œ âˆ© ğ´à¯ âˆ© ğ´à¯ àµ† â‹¯ àµ… àµ†1 à¯§à¬¿à¬µ ğ´à¬µ âˆ© â‹¯ âˆ© ğ´à¯§
à¬µà®¸à¯œà®´à¯à®´à¯à®¸à¯§
â€¢ AÂ certainÂ townÂ hasÂ 3Â clubsÂ TheÂ tennisÂ clubÂ hasÂ 20Â membersÂ theÂ 
stampÂ collectorsÂ clubÂ 15Â membersÂ andÂ theÂ EgyptologyÂ clubÂ numbersÂ 
8Â ThereÂ areÂ 2Â tennisÂ playersÂ andÂ 3Â stampÂ collectorsÂ amongÂ theÂ 
EgyptologistsÂ 6Â peopleÂ bothÂ playÂ tennisÂ andÂ collectÂ stampsÂ andÂ thereÂ 
isÂ evenÂ oneÂ busyÂ personÂ thatÂ belongsÂ toÂ allÂ threeÂ clubsÂ HowÂ manyÂ 
peopleÂ areÂ engagedÂ inÂ theÂ clubÂ life
68
Example
ğ¶ âˆª ğ‘‡ âˆª ğ¸ àµŒ ğ¶ àµ… ğ‘‡ àµ… ğ¸
àµ† ğ¶ âˆ© ğ‘‡ àµ† ğ¶ âˆ© ğ¸ àµ† ğ¸ âˆ© ğ‘‡ àµ… ğ¶ âˆ© ğ‘‡ âˆ© ğ¸
àµŒ 15 àµ… 20 àµ… 8 àµ† 2 àµ… 3 àµ… 6 àµ… 1 àµŒ 33
67
68
272024
35
Notation
andÂ inÂ general
69
where the selection is made over all ğ‘¡
ğ‘˜ kcombinations of 
the set of t conditions Then
FindÂ theÂ numberÂ ofÂ integersÂ betweenÂ 1Â andÂ 1000Â inclusiveÂ whichÂ areÂ divisibleÂ 
byÂ noneÂ ofÂ 5Â 6Â andÂ 8
70
Example
â€¢ ğ‘à¬µ property of being divisible by 5
â€¢ ğ‘à¬¶ property of being divisible by 6
â€¢ ğ‘à¬· property of being divisible by 8
â€¢ ğ‘† àµŒ áˆ¼12 â€¦  1000áˆ½
â€¢ ğ´à¯œ subset of S
satisfying ğ‘à¯œ
WeÂ wishÂ toÂ findÂ  ğ´à¬µ âˆ© ğ´à¬¶ âˆ© ğ´à¬·
ğ‘à´¥ àµŒ ğ‘†à¬´ àµ† ğ‘†à¬µ àµ… ğ‘†à¬¶ àµ† ğ‘†à¬· àµŒ 1000 àµ† 200 àµ… 166 àµ… 125 àµ… 33 àµ… 25 àµ… 41 àµ† 8 àµŒ 600
69
70
272024
36
FindÂ theÂ numberÂ ofÂ nonâ€negativeÂ integerÂ solutionsÂ toÂ ğ‘¥à¬µ àµ… ğ‘¥à¬¶ àµ… ğ‘¥à¬· àµ… ğ‘¥à¬¸ àµŒ
20 subjectÂ toÂ ğ‘¥à¯œ àµ‘ 8 1 àµ‘ ğ‘– àµ‘ 4
71
Example
â€¢ ğ‘† àµŒ nonnegative integers solutions to ğ‘¥à¬µ àµ… ğ‘¥à¬¶ àµ… ğ‘¥à¬· àµ… ğ‘¥à¬¸ àµŒ 20
â‡’ ğ‘† àµŒ permutations of 20 Â· 13 Â· 0 àµŒ ğ¶ 2320 àµŒ ğ¶áˆº233áˆ»
â€¢ ğ‘à¯œ àµŒ property that ğ‘¥à¯œ àµ 8 â‡’ ğ´à¯œ àµŒ solutions satisfying ğ‘à¯œ
â€¢ What is ğ´à¯œ 
â€“ Bijection from solutions of ğ‘¥à¬µ àµ… ğ‘¥à¬¶ àµ… ğ‘¥à¬· àµ… ğ‘¥à¬¸ àµŒ 11 to solutions in ğ´à¯œ
â€“ Then ğ´à¯œ àµŒ ğ¶ 11 àµ… 311
â€¢ Similarly ğ´à¯œ âˆ© ğ´à¯ àµŒ solutions to ğ‘¥à¬µ àµ… ğ‘¥à¬¶ àµ… ğ‘¥à¬· àµ… ğ‘¥à¬¸ àµŒ 2 ie ğ¶áˆº2 àµ… 32áˆ»
ConsiderÂ aÂ regionÂ withÂ fiveÂ villagesÂ YouÂ wishÂ toÂ buildÂ aÂ systemÂ ofÂ roadsÂ soÂ thatÂ 
noÂ villageÂ isÂ completelyÂ isolatedÂ althoughÂ itÂ mayÂ remainÂ disconnectedÂ fromÂ 
specificÂ villagesÂ ieÂ theÂ resultingÂ graphÂ mayÂ notÂ beÂ connectedÂ InÂ howÂ manyÂ 
waysÂ canÂ thisÂ beÂ done
72
Example
â€¢ ğ‘† set of all graphs on ğ‘‰ àµŒ áˆ¼12345áˆ½  How many
â€¢
ğ‘† àµŒ 2
à°±
à°® àµŒ 2à¬µà¬´ àµŒ 1024
â€¢ ğ‘à¯œ village i is isolated ğ´à¯œ graphs in S satisfying ğ‘à¯œ
â€¢ We want ğ´à¬µ âˆ© ğ´à¬¶ âˆ© ğ´à¬· âˆ© ğ´à¬¸ âˆ© ğ´à¬¹
â€¢ Can you find ğ‘†à¬µ ğ‘†à¬¶ ğ‘†à¬· ğ‘†à¬¸ ğ‘†à¬¹ 
2à¬µà¬´ àµ† 5
1 2à¬º àµ… 5
2 2à¬· àµ† 5
3 2à¬µ àµ… 5
4 2à¬´ àµ† 5
5 1 àµŒ 768
ğ‘à´¥ àµŒ ğ‘†à¬´ àµ† ğ‘†à¬µ àµ… ğ‘†à¬¶ àµ† ğ‘†à¬· àµ… ğ‘†à¬¸ àµ† ğ‘†à¬¹ àµŒ
71
72
272024
37
InÂ howÂ manyÂ waysÂ canÂ sixÂ marriedÂ couplesÂ beÂ seatedÂ atÂ aÂ circularÂ tableÂ 
soÂ thatÂ noÂ oneÂ sitsÂ nextÂ toÂ theirÂ spouse
73
Example
â€¢ ğ‘† set of all sitting arrangements How many
ğ‘† àµŒ 11
â€¢
ğ‘à¯œ members of couple i sit together  ğ‘áˆºğ‘à¬µáˆ» 
â€¢ PreviouslyÂ weÂ computedÂ theÂ numberÂ ğ¶áˆºğ‘› ğ‘Ÿáˆ» ofÂ râ€combinationsÂ ofÂ aÂ setÂ S
andÂ theÂ numberÂ ğ¶áˆºğ‘Ÿ àµ… ğ‘˜ àµ† 1 ğ‘Ÿáˆ» ofÂ râ€combinationsÂ ofÂ aÂ multisetÂ withÂ k
classesÂ ofÂ unlimitedÂ multiplicityÂ 
â€¢ WeÂ nowÂ lookÂ atÂ multisetsÂ withÂ finiteÂ repetitionÂ counts
74
râ€CombinationsÂ ofÂ multisetsÂ withÂ finiteÂ repetitionÂ counts
ExerciseÂ ComputeÂ theÂ numberÂ ofÂ 10â€combinationsÂ ofÂ theÂ multisetÂ 
3 Â· ğ‘Ÿ 4 Â· ğ‘” 5 Â· ğ‘ 
WeÂ canÂ doÂ thisÂ byÂ imposingÂ additionalÂ conditionsÂ onÂ theÂ 10â€combinationsÂ 
ofÂ  âˆ Â· ğ‘Ÿ âˆ Â· ğ‘” âˆ Â· ğ‘
73
74
272024
38
â€¢ GivenÂ t propertiesÂ ğ‘à¬µ â€¦  ğ‘à¯§Â andÂ aÂ setÂ ğ‘†Â letÂ ğ¸à¯  respÂ ğ¿à¯ Â denoteÂ theÂ 
numberÂ ofÂ elementsÂ ofÂ ğ‘† thatÂ satisfyÂ exactlyÂ respÂ atÂ leastÂ ğ‘š ofÂ theÂ 
propertiesÂ 
NoteÂ soÂ farÂ weÂ haveÂ onlyÂ consideredÂ theÂ casesÂ ğ¸à¬´ andÂ ğ¿à¬µ
75
GeneralizedÂ Inclusionâ€Exclusion
Corollary
TheoremÂ UnderÂ theÂ sameÂ hypothesisÂ asÂ theÂ inclusionâ€exclusionÂ principleÂ forÂ 
eachÂ 1 àµ‘ ğ‘š àµ‘ ğ‘¡Â theÂ numberÂ ofÂ elementsÂ ofÂ ğ‘† thatÂ satisfyÂ exactlyÂ ğ‘š ofÂ theÂ 
propertiesÂ ğ‘à¬µ â€¦  ğ‘à¯§ is
â€¢ VerifyÂ theÂ specialÂ caseÂ ğ¸à¯ Â forÂ ğ‘¡ àµŒ 3 ğ‘š àµŒ 1Â usingÂ VennÂ diagramsÂ 
eachÂ regionÂ hasÂ beenÂ numberedÂ forÂ easyÂ reference
76
Example
â€¢ ğ‘†à¬µ overestimatesÂ theÂ actualÂ numberÂ 
asÂ regionsÂ 3Â 5Â 6Â areÂ countedÂ twiceÂ 
andÂ regionÂ 7Â isÂ countedÂ 3Â times
â€¢ IfÂ weÂ subtractÂ 2ğ‘†à¬¶ weÂ endÂ withÂ Â aÂ netÂ 
lossÂ ofÂ 3Â forÂ regionÂ 7Â whichÂ needsÂ toÂ 
beÂ addedÂ back
â€¢ CorrectÂ formulaÂ isÂ ğ‘†à¬µ àµ† 2ğ‘†à¬¶ àµ… 3ğ‘†à¬·
75
76
272024
39
GeneralizedÂ InclusionÂ ExclusionÂ ğ¸à¬µ withÂ t=4
1
2
1
3
2
3
4
3
2
2
3
2
1
2
1
+S1
GeneralizedÂ InclusionÂ ExclusionÂ ğ¸à¬µ withÂ t=4
1
2
1
3
2
3
4
3
2
2
3
2
1
2
1
+S1 â€“ 2S2
77
78
272024
40
GeneralizedÂ InclusionÂ ExclusionÂ ğ¸à¬µ withÂ t=4
1
0
1
â€“3
0
â€“3
â€“8
â€“3
0
0
â€“3
0
1
0
1
+S1 â€“ 2S2
GeneralizedÂ InclusionÂ ExclusionÂ ğ¸à¬µ withÂ t=4
1
0
1
â€“3
0
â€“3
â€“8
â€“3
0
0
â€“3
0
1
0
1
+S1 â€“ 2S2 + 3S3
79
80
272024
41
GeneralizedÂ InclusionÂ ExclusionÂ ğ¸à¬µ withÂ t=4
1
0
1
0
0
0
4
0
0
0
0
0
1
0
1
+S1 â€“ 2S2 + 3S3
GeneralizedÂ InclusionÂ ExclusionÂ ğ¸à¬µ withÂ t=4
1
0
1
0
0
0
4
0
0
0
0
0
1
0
1
+S1 â€“ 2S2 + 3S3 â€“ 4S4
81
82
272024
42
GeneralizedÂ InclusionÂ ExclusionÂ ğ¸à¬µ withÂ t=4
1
0
1
0
0
0
0
0
0
0
0
0
1
0
1
+S1 â€“ 2S2 + 3S3 â€“ 4S4
GeneralizedÂ InclusionÂ ExclusionÂ ğ¸à¬µ withÂ t=4
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
â€“1
83
84
272024
43
â€¢ EightÂ CDsÂ lieÂ onÂ aÂ tableÂ outsideÂ theirÂ caseÂ nextÂ toÂ theÂ eightÂ emptyÂ 
casesÂ EachÂ CDÂ isÂ placedÂ onÂ aÂ caseÂ atÂ randomÂ oneÂ CDÂ perÂ caseÂ WhatÂ 
isÂ theÂ probabilityÂ thatÂ noÂ CDÂ isÂ returnedÂ toÂ itsÂ case
â€¢ IsÂ itÂ moreÂ orÂ lessÂ likelyÂ thatÂ noÂ CDÂ isÂ returnedÂ toÂ itsÂ caseÂ whenÂ insteadÂ 
ofÂ 8Â CDsÂ weÂ haveÂ 80Â CDs
85
WarmupÂ NothingÂ inÂ itsÂ Place
â€¢ IfÂ weÂ viewÂ aÂ permutationÂ asÂ aÂ mappingÂ aÂ derangement isÂ aÂ 
permutationÂ inÂ whichÂ noÂ elementÂ mapsÂ toÂ itselfÂ suchÂ asÂ 31254Â 
23451Â 54321Â etc
â€¢ Examples
ï€­InÂ howÂ manyÂ waysÂ canÂ youÂ placeÂ betsÂ onÂ theÂ arrivingÂ positionsÂ ofÂ 8Â raceÂ 
carsÂ soÂ thatÂ youÂ loseÂ all yourÂ bets
ï€­ InÂ howÂ manyÂ waysÂ canÂ youÂ returnÂ 8Â CDsÂ toÂ theirÂ casesÂ soÂ thatÂ noÂ CDÂ isÂ 
inÂ theÂ rightÂ case
ï€­ EightÂ couplesÂ arriveÂ atÂ aÂ partyÂ InÂ howÂ manyÂ waysÂ canÂ theyÂ chooseÂ 
dancingÂ partnersÂ soÂ thatÂ noÂ oneÂ dancesÂ withÂ theirÂ spouse
86
Derangements
85
86
272024
44
â€¢ WeÂ denoteÂ byÂ ğ‘‘à¯¡ theÂ numberÂ ofÂ derangementsÂ ofÂ áˆ¼12 â€¦  ğ‘›áˆ½
87
Derangementsâ€¦
WeÂ getÂ theÂ sequenceÂ ofÂ ğ‘‘à¯œâ€™sÂ Â 0 1 2 9 44 265 1854 14833 133496 â€¦
ğ‘› àµŒ 1  ğ‘‘à¬µ àµŒ 0Â asÂ 1 isÂ theÂ onlyÂ permutation
ğ‘› àµŒ 2  ğ‘‘à¬¶ àµŒ 1Â asÂ 21 isÂ theÂ onlyÂ derangement
ğ‘› àµŒ 3  ğ‘‘à¬· àµŒ 2Â fromÂ 231 andÂ 312
ğ‘› àµŒ 4  ğ‘‘à¬¸ àµŒ 9Â fromÂ theÂ followingÂ permutations
ğŸğŸ’ğŸğŸ‘
ğŸğŸ‘ğŸ’ğŸ
ğŸğŸğŸ’ğŸ‘
ğŸ‘ğŸ’ğŸğŸ
ğŸ‘ğŸ’ğŸğŸ
ğŸ‘ğŸğŸ’ğŸ
ğŸ’ğŸ‘ğŸğŸ
ğŸ’ğŸ‘ğŸğŸ
ğŸ’ğŸğŸğŸ‘
TheoremÂ ForÂ ğ‘› àµ’ 1Â 
88
TheÂ numberÂ ofÂ derangements
ğ‘‘à¯¡ àµŒ ğ‘› 1 àµ† 1
1 àµ… 1
2 àµ† 1
3 àµ… â‹¯ àµ… àµ†1 à¯¡ 1
ğ‘›
ProofÂ HereÂ ğ‘† isÂ theÂ setÂ ofÂ permutationsÂ ofÂ 1 â€¦  ğ‘›Â soÂ ğ‘†à¬´ àµŒ ğ‘›
ForÂ ğ‘— àµŒ 1 â€¦  ğ‘›Â ğ‘à¯ isÂ theÂ conditionÂ thatÂ inÂ aÂ permutationÂ ğ‘— isÂ inÂ itsÂ naturalÂ positionÂ Â Â Â Â 
ForÂ exampleÂ aÂ permutationÂ ğ‘–à¬µğ‘–à¬¶ â€¦ ğ‘–à¯¡ satisfiesÂ ğ‘à¬µ ifÂ itÂ hasÂ theÂ formÂ 1ğ‘–à¬¶ â€¦ ğ‘–à¯¡Â ieÂ ifÂ ğ‘–à¬µ àµŒ 1
ThusÂ ğ‘ ğ‘à¬µ àµŒ ğ‘› àµ† 1  andÂ ğ‘†à¬µ àµŒ ğ¶ ğ‘› 1
ğ‘› àµ† 1  àµŒ ğ‘›
SimilarlyÂ permutationsÂ inÂ ğ´à¬µ âˆ© ğ´à¬¶ areÂ ofÂ theÂ formÂ 12ğ‘–à¬· â€¦ ğ‘–à¯¡ andÂ ğ‘ ğ‘à¬µğ‘à¬¶ àµŒ ğ‘› àµ† 2 Â 
ThereforeÂ ğ‘†à¬¶ àµŒ ğ¶ ğ‘› 2
ğ‘› àµ† 2  àµŒ ğ‘›2
MoreÂ generallyÂ forÂ anyÂ 1 àµ‘ ğ‘˜ àµ‘ ğ‘›Â theÂ permutationsÂ inÂ ğ´à¬µ âˆ© ğ´à¬¶ âˆ© â‹¯ âˆ© ğ´à¯ haveÂ theÂ 
formÂ 12 â€¦ ğ‘˜ğ‘–à¯à¬¾à¬µ â€¦ ğ‘–à¯¡Â whereÂ ğ‘–à¯à¬¾à¬µ â€¦ ğ‘–à¯¡ isÂ anÂ arbitraryÂ permutationÂ ofÂ ğ‘˜ àµ… 1 â€¦  ğ‘›
ThusÂ ğ‘ ğ‘à¬µğ‘à¬¶ â‹¯ ğ‘à¯ àµŒ ğ‘› àµ† ğ‘˜  andÂ ğ‘†à¯ àµŒ ğ¶ ğ‘› ğ‘˜
ğ‘› àµ† ğ‘˜ 
AÂ directÂ applicationÂ ofÂ theÂ inclusionâ€exclusionÂ principleÂ yields
ğ‘‘à¯¡ àµŒ ğ‘†à¬´ àµ† ğ‘†à¬µ àµ… â‹¯ àµ… àµ†1 à¯¡ğ‘†à¯¡ àµŒ ğ‘› 1 àµ† 1
1 àµ… 1
2 àµ† 1
3 àµ… â‹¯ àµ… àµ†1 à¯¡ 1
ğ‘›   âˆ  
87
88
272024
45
â€¢ RecallÂ fromÂ basicÂ calculus
89
HowÂ doesÂ ğ‘‘à¯¡ changeÂ asÂ ğ‘› grows
â€¢ In particular for ğ‘¥ àµŒ àµ†1
ğ‘’à¬¿à¬µ àµŒ 1 àµ† 1
1 àµ… 1
2 àµ† 1
3 àµ… 1
4 àµ† 1
5 àµ… â‹¯
â€¢ Therefore
lim
à¯¡â†’à®¶
à¯—à³™
à¯¡ àµŒ ğ‘’à¬¿à¬µ
and  
à¯—à³™
à¯¡ àµ†
à¬µ
à¯˜ àµ‘
à¬µ
à¯¡à¬¾à¬µ 
ğ‘’à¯« àµŒ 1 àµ… ğ‘¥ àµ… ğ‘¥à¬¶
2 àµ… ğ‘¥à¬·
3 àµ… ğ‘¥à¬¸
4 àµ… â‹¯ àµ… ğ‘¥à¯
ğ‘˜ àµ… â‹¯
â€¢ SinceÂ ğ‘‘à¯¡ isÂ theÂ Â ofÂ permutationsÂ ofÂ áˆ¼1 â€¦  ğ‘›áˆ½ thatÂ areÂ derangementsÂ 
thenÂ theÂ probabilityÂ thatÂ aÂ randomÂ permutationÂ isÂ aÂ derangementÂ is
90
DerangementsÂ inÂ RandomÂ Permutations
ğ‘‘à¯¡
ğ‘› àµ ğ‘’à¬¿à¬µ àµ 03679
â€¢ ThisÂ probabilityÂ isÂ largelyÂ independentÂ ofÂ ğ‘›
89
90
272024
46
Theorem ğ‘‘à¯¡ àµŒ ğ‘› àµ† 1
ğ‘‘à¯¡à¬¿à¬µ àµ… ğ‘‘à¯¡à¬¿à¬¶ forÂ ğ‘› àµŒ 345 â€¦
91
RecursiveÂ Structure
Proof EulerÂ TheÂ ğ‘‘à¯¡ derangementsÂ ofÂ áˆ¼1 â€¦  ğ‘›áˆ½ canÂ beÂ partitionedÂ intoÂ ğ‘› àµ† 1 classesÂ 
dependingÂ onÂ whichÂ ofÂ 23 â€¦  ğ‘› appearsÂ inÂ theÂ firstÂ positionÂ SinceÂ eachÂ classÂ â€œlooksÂ theÂ 
sameâ€Â ğ‘‘à¯¡ àµŒ ğ‘› àµ† 1 ğ‘¡à¯¡ whereÂ ğ‘¡à¯¡ isÂ theÂ numberÂ ofÂ derangementsÂ ofÂ theÂ formÂ 2ğ‘–à¬¶ğ‘–à¬· â€¦ ğ‘–à¯¡
FurtherÂ partitionÂ theÂ ğ‘¡à¯¡ derangementsÂ intoÂ twoÂ typesÂ ğ‘¡à¯¡á‡± derangementsÂ ofÂ theÂ formÂ 
21ğ‘–à¬·ğ‘–à¬¸ â€¦ ğ‘–à¯¡Â andÂ ğ‘¡à¯¡á‡±á‡± derangementsÂ ofÂ theÂ formÂ 2ğ‘–à¬¶ğ‘–à¬·ğ‘–à¬¸ â€¦ ğ‘–à¯¡ withÂ ğ‘–à¬¶ àµ 1 ğ‘–à¬· àµ 3 ğ‘–à¬¸ àµ
4 â€¦ ğ‘–à¯¡ àµ ğ‘›Â ButÂ ğ‘¡à¯¡á‡± àµŒ ğ‘‘à¯¡à¬¿à¬¶ andÂ byÂ relabelingÂ weÂ canÂ seeÂ thatÂ ğ‘¡à¯¡á‡±á‡± àµŒ ğ‘‘à¯¡à¬¿à¬µÂ whichÂ 
concludesÂ theÂ proof
92
By iterating this recurrence you get an alternative proof of
ğ‘‘à¯¡ àµŒ ğ‘› àµ† 1
ğ‘‘à¯¡à¬¿à¬µ àµ… ğ‘‘à¯¡à¬¿à¬¶
91
92
272024
47
AÂ classÂ ofÂ n childrenÂ takesÂ aÂ walkÂ everyÂ dayÂ inÂ aÂ singleÂ fileÂ everyÂ childÂ 
exceptÂ theÂ firstÂ isÂ precededÂ byÂ anotherÂ childÂ SinceÂ itÂ isÂ notÂ veryÂ 
interestingÂ toÂ alwaysÂ seeÂ theÂ sameÂ personÂ inÂ frontÂ ofÂ youÂ onÂ theÂ 
secondÂ dayÂ theyÂ decideÂ toÂ switchÂ positionsÂ soÂ thatÂ noÂ childÂ isÂ 
precededÂ byÂ theÂ sameÂ childÂ fromÂ theÂ previousÂ dayÂ InÂ howÂ manyÂ waysÂ 
canÂ theÂ childrenÂ switchÂ positions
93
Exercise
Hint we want the permutations that do not contain any of the patterns 
12 23 34 â€¦  ğ‘› àµ† 1 ğ‘›
â€¢ TheÂ numberÂ ofÂ permutationsÂ ofÂ áˆ¼1 â€¦  ğ‘›áˆ½ thatÂ doÂ notÂ containÂ anyÂ ofÂ theÂ 
patternsÂ 12 23 34 â€¦  ğ‘› àµ† 1 ğ‘› isÂ denotedÂ byÂ ğ‘à¯¡
94
RelativeÂ ForbiddenÂ Positions
ğ‘à¯¡ àµŒ ğ‘› àµ† ğ‘› àµ† 1
1
ğ‘› àµ† 1  àµ… ğ‘› àµ† 1
2
ğ‘› àµ† 2  àµ† ğ‘› àµ† 1
3
ğ‘› àµ† 3  àµ… â‹¯ àµ… àµ†1 à¯¡ ğ‘› àµ† 1
ğ‘› àµ† 1 1
TheoremÂ For ğ‘› àµ’ 1
TheoremÂ  ğ‘à¯¡ àµŒ ğ‘‘à¯¡ àµ… ğ‘‘à¯¡à¬¿à¬µ
93
94
272024
48
â€¢ InÂ howÂ manyÂ waysÂ canÂ youÂ placeÂ 
8Â rooksÂ inÂ aÂ 8 àµˆ 8 chessboardÂ soÂ 
thatÂ noÂ twoÂ ofÂ themÂ canÂ takeÂ 
eachÂ other
â€¢ HowÂ aboutÂ ifÂ someÂ positionsÂ 
shadedÂ blocksÂ areÂ forbidden
95
RookÂ polynomialsÂ Warmup
â€¢ ManyÂ problemsÂ thatÂ haveÂ nothingÂ toÂ doÂ withÂ chessÂ canÂ beÂ modeledÂ 
usingÂ arrangementsÂ ofÂ rooksÂ onÂ aÂ board
ExampleÂ ProfessorÂ RookÂ hasÂ toÂ gradeÂ fiveÂ finalsÂ andÂ hasÂ fiveÂ studentsÂ toÂ 
helpÂ withÂ gradingÂ EachÂ graderÂ shouldÂ getÂ exactlyÂ oneÂ examÂ inÂ aÂ topicÂ 
theyÂ knowÂ InÂ howÂ manyÂ waysÂ canÂ thisÂ beÂ done
ModelÂ asÂ 5 àµˆ 5 chessboardÂ withÂ forbiddenÂ rookÂ positions
96
RookÂ polynomials
aÂ forbiddenÂ position
95
96
272024
49
â€¢ LetÂ ğ¶ denoteÂ aÂ specificÂ ğ‘š àµˆ ğ‘› boardÂ ThenÂ ğ‘Ÿà¯áˆºğ¶áˆ» denotesÂ theÂ numberÂ ofÂ 
waysÂ inÂ whichÂ ğ‘˜ rooksÂ canÂ beÂ placedÂ inÂ ğ¶ soÂ thatÂ noÂ twoÂ attackÂ eachÂ 
otherÂ ieÂ noÂ twoÂ occupyÂ eitherÂ theÂ sameÂ rowÂ orÂ theÂ sameÂ columnÂ 
â€¢ ForÂ convenienceÂ weÂ defineÂ ğ‘Ÿà¬´ ğ¶ àµŒ 1
â€¢ TheÂ rookÂ polynomialÂ ofÂ ğ¶Â denotedÂ ğ‘Ÿ ğ¶ ğ‘¥ Â isÂ definedÂ as
97
Notation
ğ‘Ÿ ğ¶ ğ‘¥ àµŒ à· ğ‘Ÿà¯ ğ¶ ğ‘¥à¯
à®¶
à¯à­€à¬´
NoteÂ theÂ coefficientÂ ofÂ ğ‘¥à¯ isÂ theÂ numberÂ ofÂ waysÂ inÂ whichÂ ğ‘˜ nonâ€attackingÂ 
rooksÂ canÂ beÂ placedÂ inÂ ğ¶
â€¢ ConsiderÂ aÂ chessboardÂ ğ¶ ofÂ sizeÂ ğ‘› àµˆ ğ‘› withÂ rookÂ polynomialÂ 
â„›à¯¡ ğ‘¥ àµŒ ğ‘Ÿáˆºğ¶ ğ‘¥áˆ»Â Then
98
Example
ExerciseÂ WhatÂ isÂ â„›à¬¸ ğ‘¥ 
â„›à¬µ ğ‘¥ àµŒ 1 àµ… ğ‘¥
â„›à¬¶ ğ‘¥ àµŒ 1 àµ… 4ğ‘¥ àµ… 2ğ‘¥à¬¶
â„›à¬· ğ‘¥ àµŒ 1 àµ… 9ğ‘¥ àµ… 18ğ‘¥à¬¶ àµ… 6ğ‘¥à¬·
ExerciseÂ WhatÂ isÂ â„›à¯¡ ğ‘¥ 
ExerciseÂ WhatÂ isÂ â„›à¯ à¯¡ ğ‘¥ 
97
98
272024
50
â€¢ InÂ thisÂ exampleÂ theÂ boardÂ containsÂ forbiddenÂ positionsÂ markedÂ withÂ àµˆ
99
Example
ğ‘Ÿ ğ¶ ğ‘¥ àµŒ 1 àµ… 6ğ‘¥ àµ… 8ğ‘¥à¬¶ àµ… 2ğ‘¥à¬·
â€¢ TheÂ caseâ€byâ€caseÂ analysisÂ usedÂ soÂ farÂ quicklyÂ becomesÂ unmanageableÂ 
forÂ largeÂ boards
â€¢ TwoÂ techniquesÂ decomposition andÂ reduction makeÂ theÂ analysisÂ 
simpler
ï€­IfÂ aÂ largeÂ boardÂ ğ¶ canÂ beÂ partitionedÂ intoÂ ğ‘˜ independentÂ subâ€boardsÂ 
ğ¶à¬µ ğ¶à¬¶ â€¦  ğ¶à¯Â decomposition allowsÂ youÂ toÂ computeÂ theÂ polynomialÂ ofÂ 
ğ¶ byÂ multiplyingÂ theÂ polynomialsÂ ofÂ Â ğ¶à¬µ ğ¶à¬¶ â€¦  ğ¶à¯
ï€­Reduction usesÂ theÂ AdditionÂ RuleÂ toÂ computeÂ theÂ polynomialÂ ofÂ ğ¶ fromÂ 
theÂ polynomialsÂ ofÂ twoÂ smallerÂ boardsÂ thatÂ resultÂ fromÂ eitherÂ placingÂ aÂ 
rookÂ orÂ notÂ atÂ aÂ arbitrarilyÂ chosenÂ cellÂ ofÂ ğ¶
100
AnalysisÂ Techniques
99
100
272024
51
â€¢ GivenÂ aÂ boardÂ ğ¶Â twoÂ subâ€boardsÂ areÂ independentÂ ifÂ theyÂ shareÂ noÂ 
openÂ cellsÂ inÂ theÂ sameÂ rowÂ orÂ sameÂ column
101
Decomposition
ğ¶à¬µ
ğ¶à¬¶
ğ‘Ÿ ğ¶à¬µ ğ‘¥ àµŒ 1 àµ… 3ğ‘¥ àµ… ğ‘¥à¬¶
ğ‘Ÿ ğ¶à¬¶ ğ‘¥ àµŒ 1 àµ… 9ğ‘¥ àµ… 18ğ‘¥à¬¶ àµ… 6ğ‘¥à¬·
ğ‘Ÿ ğ¶ ğ‘¥ àµŒ ğ‘Ÿ ğ¶à¬µ ğ‘¥ Â· ğ‘Ÿ ğ¶à¬¶ ğ‘¥ àµŒ 1 àµ… 12ğ‘¥ àµ… 46ğ‘¥à¬¶ àµ… 69ğ‘¥à¬· àµ… 36ğ‘¥à¬¸ àµ… 6ğ‘¥à¬¹
TheoremÂ  IfÂ ğ¶ isÂ aÂ boardÂ madeÂ upÂ ofÂ pairwiseÂ independentÂ subâ€boardsÂ ğ¶à¬µ â€¦  ğ¶à¯
thenÂ ğ‘Ÿ ğ¶ ğ‘¥ àµŒ ğ‘Ÿ ğ¶à¬µ ğ‘¥ Â· ğ‘Ÿ ğ¶à¬¶ ğ‘¥ â‹¯ ğ‘Ÿáˆºğ¶à¯ ğ‘¥áˆ»
â€¢ UsesÂ theÂ additionÂ ruleÂ byÂ decidingÂ whetherÂ toÂ placeÂ aÂ rookÂ orÂ notÂ onÂ aÂ 
givenÂ cellÂ ofÂ ğ¶
102
Reduction
â€¢ SinceÂ theÂ twoÂ casesÂ coverÂ allÂ possibilitiesÂ andÂ areÂ mutuallyÂ disjointÂ 
byÂ theÂ additionÂ ruleÂ ğ‘Ÿà¯ ğ¶ àµŒ ğ‘Ÿà¯à¬¿à¬µ ğ¶à¯” àµ… ğ‘Ÿà¯áˆºğ¶à¯•áˆ»
ğ¶à¯”
ğ¶à¯•
101
102
272024
52
â€¢ ComputeÂ theÂ rookÂ polynomialÂ ofÂ theÂ board
103
Example
â€¢ IfÂ ğµ isÂ aÂ boardÂ ğµÂ denotesÂ ğ‘Ÿáˆºğµ ğ‘¥áˆ»
â€¢ BackÂ toÂ ProfÂ RookÂ exampleÂ HeÂ needsÂ toÂ 
assignÂ exactlyÂ oneÂ Â graderÂ toÂ eachÂ examÂ 
104
Example
â€¢ AfterÂ rearrangingÂ columnsÂ firstÂ andÂ thenÂ rowsÂ weÂ get
103
104
272024
53
â€¢ OnceÂ againÂ weÂ useÂ inclusionâ€exclusion
ï€­ LetÂ ğ‘† àµŒ unconstrainedÂ assignmentsÂ oneÂ graderÂ perÂ exam
ï€­ LetÂ ğ‘à¯œ àµŒ ğ‘–â€th graderÂ isÂ assignedÂ toÂ aÂ forbiddenÂ exam
ï€­ WeÂ wantÂ ğ‘ ğ‘à¬µà´¥ ğ‘à¬¶à´¥ ğ‘à¬·à´¥ ğ‘à¬¸à´¥ ğ‘à¬¹à´¥
àµŒ ğ´à¬µ âˆ© ğ´à¬¶ âˆ© ğ´à¬· âˆ© ğ´à¬¸ âˆ© ğ´à¬¹ àµŒ ğ‘†à¬´ àµ† ğ‘†à¬µ àµ… ğ‘†à¬¶ àµ† ğ‘†à¬· àµ… ğ‘†à¬¸ àµ† ğ‘†à¬¹
â€¢ ClearlyÂ ğ‘†à¬´ àµŒ 5 àµŒ 120
105
CountingÂ Â ofÂ ValidÂ Assignments
ğ‘ ğ‘à¬µğ‘à¬¶ àµ… ğ‘ ğ‘à¬µğ‘à¬· àµ… ğ‘ ğ‘à¬µğ‘à¬¸ àµ… ğ‘ ğ‘à¬µğ‘à¬¹ àµ… ğ‘ ğ‘à¬¶ğ‘à¬· àµ… ğ‘ ğ‘à¬¶ğ‘à¬¸ àµ… ğ‘ ğ‘à¬¶ğ‘à¬¹
àµ… ğ‘ ğ‘à¬·ğ‘à¬¸ àµ… ğ‘ ğ‘à¬·ğ‘à¬¹ àµ… ğ‘ ğ‘à¬¸ğ‘à¬¹
â€¢ ğ‘†à¬¶ isÂ givenÂ by
â€¢ ğ‘†à¬µ isÂ givenÂ by
ğ‘†à¬µ àµŒ ğ‘ ğ‘à¬µ àµ… ğ‘ ğ‘à¬¶ àµ… ğ‘ ğ‘à¬· àµ… ğ‘ ğ‘à¬¸ àµ… ğ‘ ğ‘à¬¹
â€¢ ProceedÂ similarlyÂ forÂ ğ‘†à¬· ğ‘†à¬¸ ğ‘†à¬¹
â€¢ ThereforeÂ ğ‘†à¬µ àµŒ 8 4 àµŒ 192
106
ComputingÂ ğ‘†à¬µ
Graders
Exams
â€¢ ğ‘ ğ‘à¬µ àµŒ 4 àµ… 4 assigningÂ SamÂ toÂ eachÂ ofÂ ListÂ orÂ Fortran
â€¢ ğ‘ ğ‘à¬¶ àµŒ 4 àµ… 4 assigningÂ JaneÂ toÂ eachÂ ofÂ ListÂ orÂ Fortran
â€¢ ğ‘ ğ‘à¬· àµŒ 4 assigningÂ PeteÂ toÂ Java
â€¢ ğ‘ ğ‘à¬¸ àµŒ 4 assigningÂ ChuckÂ toÂ C
â€¢ ğ‘ ğ‘à¬¹ àµŒ 4 àµ… 4 assigningÂ TomÂ toÂ eachÂ ofÂ CÂ orÂ Python
105
106
272024
54
â€¢ ğ‘ ğ‘à¬µğ‘à¬¶ àµŒ 2 â‹… 3Â asÂ thereÂ areÂ 2Â waysÂ toÂ assignÂ SamÂ 
andÂ JaneÂ toÂ twoÂ differentÂ examsÂ withÂ bothÂ occupyingÂ 
aÂ forbiddenÂ positionÂ andÂ 3 waysÂ toÂ assignÂ theÂ restÂ 
toÂ differentÂ examsÂ withoutÂ regardÂ toÂ constraints
107
ComputingÂ ğ‘†à¬¶
â€¢ Thus ğ‘†à¬¶ àµŒ 22 3 àµŒ 132
â€¢ ğ‘ ğ‘à¬µğ‘à¬¹ àµŒ áˆº2 â‹… 2áˆ» â‹… 3Â asÂ SandraÂ andÂ TomÂ canÂ beÂ 
assignedÂ freelyÂ toÂ anyÂ ofÂ theirÂ forbiddenÂ positions
â€¢ ForÂ theÂ remainingÂ 2â€combinationsÂ weÂ get
â€¢ ThereÂ isÂ aÂ relationshipÂ betweenÂ theÂ ğ‘†à¯œâ€™sÂ andÂ theÂ rookÂ polynomialÂ forÂ 
theÂ complementÂ board ğ¶à¯™ ofÂ forbiddenÂ positionsÂ obtainedÂ byÂ 
swappingÂ theÂ stateÂ ofÂ eachÂ cell
â€¢ EachÂ permutationÂ inÂ ğ‘†à¯œ consistsÂ ofÂ ğ‘– forbiddenÂ choicesÂ followedÂ byÂ 
ğ‘› àµ† ğ‘– arbitraryÂ choices
â€¢ ThusÂ ğ‘†à¬µ àµŒ ğ‘Ÿà¬µ ğ¶à¯™
5 àµ† 1 Â ğ‘†à¬¶ àµŒ ğ‘Ÿà¬¶ ğ¶à¯™
5 àµ† 2  andÂ inÂ generalÂ ğ‘†à¯œ àµŒ
ğ‘Ÿà¯œ ğ¶à¯™
5 àµ† ğ‘– 
108
ComplementÂ Board
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ğ‘ªà¯™
ğ‘ª
107
108
272024
55
â€¢ WeÂ canÂ greatlyÂ simplifyÂ ourÂ workÂ andÂ expediteÂ theÂ solutionÂ byÂ firstÂ 
computingÂ theÂ polynomialÂ ğ‘Ÿáˆºğ¶à¯™ ğ‘¥áˆ»
â€¢ UsingÂ theÂ decompositionÂ principleÂ weÂ canÂ partitionÂ ğ¶à¯™ intoÂ threeÂ 
independentÂ subâ€boardsÂ ğ‘ªğŸ ğ‘ªğŸ ğ‘ªğŸ‘
109
ComplementÂ Boardâ€¦
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ï‚´
ğ‘Ÿ ğ¶à¬µ ğ‘¥ àµŒ 1 àµ… 4ğ‘¥ àµ… 2ğ‘¥à¬¶
ğ‘Ÿ ğ¶à¬¶ ğ‘¥ àµŒ 1 àµ… ğ‘¥
ğ‘Ÿ ğ¶à¬· ğ‘¥ àµŒ 1 àµ… 3ğ‘¥ àµ… ğ‘¥à¬¶
LetÂ ğ´ àµŒ áˆ¼1234áˆ½ andÂ ğµ àµŒ áˆ¼ğ‘¢ ğ‘£ ğ‘¤ ğ‘¥ ğ‘¦ ğ‘§áˆ½Â HowÂ manyÂ 1â€1Â functionsÂ 
ğ‘“ ğ´ â†’ ğµ satisfy
ğ‘“ 1 âˆˆ ğ‘¤ ğ‘¥ ğ‘¦ ğ‘§ 
ğ‘“ 2 âˆˆ ğ‘¢ ğ‘£ ğ‘¥ ğ‘¦ ğ‘§  
ğ‘“ 3 âˆˆ ğ‘¢ ğ‘£ ğ‘¥  
ğ‘“ 4 âˆˆ áˆ¼ğ‘¢ ğ‘£ ğ‘¥áˆ½
110
Exercise
109
110
